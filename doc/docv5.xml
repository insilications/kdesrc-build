<!-- Converted by db4-upgrade version 1.1 -->
<book xmlns="http://docbook.org/ns/docbook" version="5.0" xml:id="kdesrc-build" xml:lang="en">

<info>
<title><application>kdesrc-build</application> Script Manual</title>

<authorgroup xml:id="authors">
    <author>
        <personname><firstname>Carlos</firstname><surname>Woelz</surname></personname>
        <email>carloswoelz@imap-mail.com</email>
    </author>

<!-- TRANS:ROLES_OF_TRANSLATORS -->

</authorgroup>

<copyright>
<year>2006</year>
<year>2007</year>
<year>2008</year>
<year>2009</year>
<year>2010</year>
<year>2011</year>
<year>2012</year>
<year>2013</year>
<year>2014</year>
<year>2015</year>
<year>2016</year>
<year>2017</year>
<year>2018</year>
<year>2019</year>
<holder>Michael Pyne</holder>
</copyright>

<copyright>
<year>2005</year>
<holder>Carlos Woelz</holder>
</copyright>

<date>2018-01-20</date>
<releaseinfo><application>kdesrc-build</application> 17.12</releaseinfo>

<abstract>
<para><application>kdesrc-build</application> is a script which builds and installs <orgname class="nonprofit">KDE</orgname> software
directly from the <orgname class="nonprofit">KDE</orgname> project's source code repositories.</para>
</abstract>

<keywordset>
<keyword>KDE</keyword>
<keyword>kdesdk</keyword>
<keyword>SVN</keyword>
<keyword>Subversion</keyword>
<keyword>git</keyword>
<keyword>KDE development</keyword>
<!-- Older names for the software -->
<keyword>kdesvn-build</keyword>
<keyword>kdecvs-build</keyword>
</keywordset>

</info>

<chapter xml:id="introduction">
<title>Introduction</title>

<section xml:id="brief-intro">
<title>A brief introduction to <application>kdesrc-build</application></title>

<section xml:id="whatis-kdesrc-build">
<title>What is <application>kdesrc-build</application>?</title>

<para>
<application>kdesrc-build</application> is a script to help the <orgname class="nonprofit">KDE</orgname> community install <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.kde.org/"><orgname class="nonprofit">KDE</orgname></link> software from its <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://git-scm.com/"><application>Git</application></link> and <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://subversion.tigris.org/"><application>Subversion</application></link> source repositories,
and continue to update that software afterwards.
It is particularly intended to support those who need to supporting testing and
development of <orgname class="nonprofit">KDE</orgname> software, including users testing bugfixes and developers
working on new features.
</para>

<para>The <application>kdesrc-build</application> script can be configured to maintain a single individual
module, a full <productname>Plasma</productname> desktop with <orgname class="nonprofit">KDE</orgname> application set, or somewhere in between.
</para>

<para>To get started, see <xref linkend="getting-started"/>, or continue reading for more
detail on how <application>kdesrc-build</application> works and what is covered in this documentation.
</para>
</section>

<section xml:id="operation-in-a-nutshell">
<title><application>kdesrc-build</application> operation <quote>in a nutshell</quote></title>

<para><application>kdesrc-build</application> works by using the tools available to the user at the
command-line, using the same interfaces available to the user. When
<application>kdesrc-build</application> is run, the following sequence is followed: </para>

<orderedlist>
<listitem><para><application>kdesrc-build</application> reads in the <link linkend="cmdline">command
line</link> and <link linkend="configure-data">configuration file</link>, to
determine what to build, compile options to use, where to install,
<abbrev>etc.</abbrev></para></listitem>

<listitem><para><application>kdesrc-build</application> performs a source update for each <link linkend="module-concept">module</link>. The update continues until all modules
have been updated. Modules that fail to update normally do not stop the build
â€“ you will be notified at the end which modules did not
update.</para></listitem>

<listitem><para>Modules that were successfully updated are built, have their
test suite run, and are then installed.  To reduce the overall time spent,
<application>kdesrc-build</application> will by default start building the code as soon as the first
module has completed updating, and allow the remaining updates to continue
behind the scenes.
</para></listitem>
</orderedlist>

<tip><para>A <emphasis>very good</emphasis> overview of how <orgname class="nonprofit">KDE</orgname> modules are
built, including informative diagrams, is provided on <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.davidrevoy.com/article193/guide-building-krita-on-linux-for- cats">an online article discussing <orgname class="nonprofit">KDE</orgname>'s <application>Krita</application> application</link>.  This
workflow is what <application>kdesrc-build</application> automates for all <orgname class="nonprofit">KDE</orgname> modules.</para>
</tip>

</section>
</section>

<section xml:id="intro-toc">
<title>Documentation Overview</title>

<para>
This guide is an overview to describe the following aspects of <application>kdesrc-build</application>
operation:
</para>

<itemizedlist>
<listitem><para>An <link linkend="getting-started">overview</link> of the steps
required to get started.</para></listitem>
<listitem><para>Notable <link linkend="features">features</link>.</para></listitem>
<listitem><para>The <link linkend="configure-data">configuration file</link> syntax
and options.</para></listitem>
<listitem><para>The <link linkend="cmdline">command line options</link>.</para></listitem>
</itemizedlist>

<para>Also documented are the steps which you should perform using
other tools (<abbrev>i.e.</abbrev> steps that are not automatically performed by <application>kdesrc-build</application>).
</para>

</section>
</chapter>

<chapter xml:id="getting-started">
<title>Getting Started</title>

<para>
In this chapter, we show how to use the <application>kdesrc-build</application> to checkout modules from
the <orgname class="nonprofit">KDE</orgname> repository and build them. We also provide a basic explanation of the
<orgname class="nonprofit">KDE</orgname> source code structure and the steps you have to perform before running
the script.
</para>

<para>
All topics present in this chapter are covered with even more detail in the
<link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://community.kde.org/Guidelines_and_HOWTOs/Build_from_source">
Build from Source</link> article, at the
<link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://community.kde.org/"><orgname class="nonprofit">KDE</orgname> Community Wiki</link>.
If you are compiling <orgname class="nonprofit">KDE</orgname> for the first time, it is a good idea to read
it, or consult it as a reference source. You will find detailed information
about packaging tools and requirements, common compilation pitfalls and
strategies and information about running your new <orgname class="nonprofit">KDE</orgname> installation.
</para>

<section xml:id="before-building">
<title>Preparing the System to Build <orgname class="nonprofit">KDE</orgname></title>

<section xml:id="before-building-users">
<title>Setup a new user account</title>

<para>
It is recommended that you use a different user account to build, install,
and run your <orgname class="nonprofit">KDE</orgname> software from, since less permissions are required, and
to avoid interfering with your distribution's packages.
If you already have <orgname class="nonprofit">KDE</orgname> packages installed, the best choice
would be to create a different (dedicated) user to build and run the new <orgname class="nonprofit">KDE</orgname>.
</para>

<tip><para>Leaving your system <orgname class="nonprofit">KDE</orgname> untouched also allows you to have an
emergency fallback in case a coding mistake causes your latest software build
to be unusable.
</para></tip>

<para>
You can do also setup to install to a system-wide directory (<abbrev>e.g.</abbrev> <filename class="directory">/usr/src/local</filename>) if you wish. This document
does not cover this installation type, since we assume you know what you are doing.
</para>

</section>
<section xml:id="before-building-preparation">
<title>Ensure your system is ready to build <orgname class="nonprofit">KDE</orgname> software</title>

<para>Before using the <application>kdesrc-build</application> script (or any other building
strategy) you must install the development tools and libraries needed for <orgname class="nonprofit">KDE</orgname>.
The nearly complete list of required tools can be found from
the <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://community.kde.org/Guidelines_and_HOWTOs/Build_from_source#Install_required_devel_packages"><orgname class="nonprofit">KDE</orgname>
Community Wiki Build Requirements</link> page.
</para>

<para>Here is a list of some of the things you will need:</para>
<itemizedlist>

<listitem><para>You will need <application>CMake</application>, this software is what <orgname class="nonprofit">KDE</orgname> uses to handle
build-time configuration of the source code and generation of the specific build
commands for your system.  The required version will vary
depending on what versions of <orgname class="nonprofit">KDE</orgname> software you are building (see TechBase for
specifics), but with modern distributions the <application>CMake</application> included with your distribution
should be quite sufficient.
</para></listitem>

<listitem><para>You must also install the source control clients needed to checkout
the <orgname class="nonprofit">KDE</orgname> source code. This means you need at least the following:</para>

<itemizedlist>
<listitem><para>The <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://git-scm.com/">Git
source control manager</link>, which is used for all <orgname class="nonprofit">KDE</orgname> <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href=" https://commits.kde.org/">source code</link></para></listitem>

<listitem><para>Although it is not required, the <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://bazaar.canonical.com/">Bazaar</link> source control manager is
used for a single module (libdbusmenu-qt) that is required for the <orgname class="nonprofit">KDE</orgname>
libraries. Most users can install this library through their distribution
packages but <application>kdesrc-build</application> supports building it as well if you desire. But to
build libdbusmenu-qt, you must have Bazaar installed.</para></listitem>
</itemizedlist></listitem>

<listitem><para>The Perl scripting language is required for <application>kdesrc-build</application>, some <orgname class="nonprofit">KDE</orgname>
repositories, and <trademark class="trade">Qt</trademark> (if you build that from source).</para>

<para>The Perl that comes with your distribution should be suitable (it needs to be at
least Perl 5.14), but you will also need some additional modules (<application>kdesrc-build</application>
will warn if they are not present):</para>

<itemizedlist>
    <listitem><para>IO::Socket::SSL</para></listitem>
    <listitem><para>JSON::PP or JSON::XS</para></listitem>
    <listitem><para>YAML::PP, YAML::XS, or YAML::Syck</para></listitem>
</itemizedlist>
</listitem>

<listitem><para>You will need a full C++ development environment (compiler, standard library, runtime,
and any required development packages).  The minimum required versions vary based on the <orgname class="nonprofit">KDE</orgname> module:
the <orgname class="nonprofit">KDE</orgname> Frameworks 5 collection supports the oldest compilers, while <orgname class="nonprofit">KDE</orgname> Plasma 5 and <orgname class="nonprofit">KDE</orgname> Applications
tend to require more recent compilers.</para>
<para>The GCC 4.8 or Clang 4 compilers are the minimum recommended.  Many distributions support easily
installing these tools using a <quote>build-essentials</quote> package, an option to install
"build dependencies" with <trademark class="trade">Qt</trademark>, or similar features.  The KDE Community Wiki has a page <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://community.kde.org/Guidelines_and_HOWTOs/Build_from_source/Install_the_dependencies">tracking
recommended packages for major distributions</link>.
</para>
</listitem>

<listitem><para>You will need a build tool that actually performs the compilation steps (as generated by <application>CMake</application>). GNU Make is recommended and should be available through your package manager. <application>CMake</application> does support others options, such as the <application>Ninja</application> build tool, which can be used by <application>kdesrc-build</application> using the <link linkend="conf-custom-build-command">custom-build-command</link> configuration file option.</para></listitem>

<listitem><para>Finally, you will need the appropriate <trademark class="trade">Qt</trademark> libraries (including development packages)
for the version of <orgname class="nonprofit">KDE</orgname> software you are building.  <application>kdesrc-build</application> does not officially support building <trademark class="trade">Qt</trademark> 5 (the current major version), so it is recommended to use your distribution's development packages or to
see the KDE Community wiki page on <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://community.kde.org/Guidelines_and_HOWTOs/Build_from_source/OwnQt5">self-building Qt 5</link>.
</para></listitem>
</itemizedlist>

<note><para>Most operating system distributions include a method of easily
installing required development tools. Consult the Community Wiki page <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://community.kde.org/Guidelines_and_HOWTOs/Build_from_source#Install_required_devel_packages">Required devel packages</link> to see
if these instructions are already available.</para></note>

<important><para>
Some of these packages are divided into libraries (or programs or utilities),
and development packages. You will need at least the program or library
<emphasis>and</emphasis> its development package.
</para></important>

</section>

<section xml:id="before-building-prepare-script">
<title>Setup <application>kdesrc-build</application></title>

<section xml:id="get-kdesrc-build">
<title>Install <application>kdesrc-build</application></title>
<para>
The <orgname class="nonprofit">KDE</orgname> developers make frequent changes to <application>kdesrc-build</application> to keep it in
sync with advances in <orgname class="nonprofit">KDE</orgname> development, including improvements to the
recommended <application>kdesrc-build</application> configuration, added modules, improving <application>CMake</application>
flags, <abbrev>etc.</abbrev></para>

<para>Because of this, we recommend obtaining <application>kdesrc-build</application> directly from its
source repository and then periodically updating it.</para>

<para>You can obtain <application>kdesrc-build</application> from its source repository by running:</para>
<programlisting>
<prompt>$ </prompt><userinput><command>git <option>clone</option> <option>https://invent.kde.org/sdk/kdesrc-build.git</option> <option><filename class="directory"><replaceable>~/kdesrc-build</replaceable></filename></option></command></userinput>
</programlisting>

<para>Replace <option><replaceable>~/kdesrc-build</replaceable></option> with
the directory you would like to install to.
</para>

<para>You can update <application>kdesrc-build</application> later by running:</para>
<programlisting>
<prompt>$ </prompt><userinput><command>cd <option><filename class="directory"><replaceable>~/kdesrc-build</replaceable></filename></option></command></userinput>
<prompt>$ </prompt><userinput><command>git <option>pull</option></command></userinput>
</programlisting>

<tip><para>We recommend adding the <application>kdesrc-build</application> installation directory to
your <envar>PATH</envar> environment variable, so that you can run <application>kdesrc-build</application>
without having to fully specify its path every time.</para></tip>
</section>

<section xml:id="setup-rcfile">
<title>Prepare the configuration file</title>

<para><application>kdesrc-build</application> uses a <link linkend="configure-data">configuration
file</link> (located at <filename>~/.kdesrc-buildrc</filename>) to control
which modules are built, where they are installed to, etc.</para>

<para>You can use a program included with <application>kdesrc-build</application>, called
<application>kdesrc-build-setup</application> in order to prepare a simple
kdesrc-build configuration. You can then edit the
<filename>~/.kdesrc-buildrc</filename> from there to make any changes you see
fit.</para>

<para><application>kdesrc-build-setup</application> itself runs from a terminal
(instead of using a graphical interface), just like <application>kdesrc-build</application>, so you can
use it even if you have no graphical interface available yet.</para>

<section xml:id="setup-rcfile-manually">
<title>Manual setup of configuration file</title>

<para>You can also setup your configuration file manually, by copying the
included sample configuration file
<filename>kdesrc-buildrc-kf5-sample</filename> to
<filename>~/.kdesrc-buildrc</filename> and then editing the file.  <xref linkend="kdesrc-buildrc"/> will be a useful reference for this, especially its
<link linkend="conf-options-table">table of configuration options</link>.
</para>

<para><application>kdesrc-build</application> contains many recommended configuration files to support
<orgname class="nonprofit">KDE</orgname> Frameworks 5, <productname>Plasma</productname> 5, and other <orgname class="nonprofit">KDE</orgname> applications.  The <application>kdesrc-build-setup</application> refers to these files in the configuration file it generates, but you can also use them
yourself.  See <xref linkend="kdesrc-buildrc-including"/> for information on how
to use other configuration files from your own <filename>~/.kdesrc-buildrc</filename>.</para>

<para>You can find more information about the syntax of the <link linkend="configure-data">configuration file</link> in <xref linkend="configure-data"/> and in <xref linkend="kdesrc-buildrc"/>.
</para>
</section>
</section>
</section>
</section>

<section xml:id="configure-data">
<title>Setting the Configuration Data</title>

<para>
To use <application>kdesrc-build</application>, you should have a file in your home directory called
<filename>.kdesrc-buildrc</filename>, which sets the general options and sets the modules
you would like to download and build.
</para>

<note><para>It is possible to use different configuration files for <application>kdesrc-build</application>,
which is described in <xref linkend="kdesrc-buildrc"/>. If you need to use
multiple configurations, please see that section. Here, we will assume the
configuration is stored in <filename>~/.kdesrc-buildrc</filename>.</para></note>

<para>
The easiest way to proceed is to use the
<filename>kdesrc-buildrc-kf5-sample</filename> file as a template, changing global
options to match your wants, and also change the list of modules you want to
build.
</para>

<para>
The default settings should be appropriate to perform a
<orgname class="nonprofit">KDE</orgname> build. Some settings that you may wish to alter include:
</para>

<itemizedlist>
<listitem><para><link linkend="conf-kdedir">kdedir</link>, which changes the
destination directory that your <orgname class="nonprofit">KDE</orgname> software is installed to. This defaults to
<filename class="directory">~/kde</filename>, which is a single-user
installation.</para></listitem>

<listitem><para><link linkend="conf-branch-group">branch-group</link>, which can
be
used to choose the appropriate branch of development for the <orgname class="nonprofit">KDE</orgname> modules as a
whole. There are many supported build configurations but you will likely want to
choose <option>kf5-qt5</option> so that <application>kdesrc-build</application> downloads the latest code
based on <trademark class="trade">Qt</trademark> 5 and <orgname class="nonprofit">KDE</orgname> Frameworks 5.</para>

<tip><para><application>kdesrc-build</application> will use a default branch group if you do not choose
one, but this default will change over time, so it's better to choose one so
that the branch group does not change unexpectedly.</para></tip>
</listitem>

<listitem><para><link linkend="conf-source-dir">source-dir</link>, to control the directory
<application>kdesrc-build</application> uses for downloading the source code, running the build process, and saving
logs.
This defaults to <filename class="directory">~/kdesrc</filename>.</para></listitem>

<listitem><para><link linkend="conf-cmake-options">cmake-options</link>, which
sets the options to pass to the <application>CMake</application> command when building each module.
Typically this is used to set between <quote>debug</quote> or
<quote>release</quote> builds, to enable (or disable) optional features, or to
pass information to the build process about the location of required libraries.
</para></listitem>

<listitem><para><link linkend="conf-make-options">make-options</link>, which
sets the options used when actually running the <application>make</application>
command to build each module (once <application>CMake</application> has established the build system).
</para>

<para>The most typical option is <option>-j<replaceable>N</replaceable></option>,
where <replaceable>N</replaceable> should be replaced with the maximum number of
compile jobs you wish to allow.  A higher number (up to the number of logical CPUs
your system has available) leads to quicker builds, but requires more system resources.
</para>

<tip><para><application>kdesrc-build</application> sets the option <option><link linkend="conf-num-cores">num-cores</link></option> to
the detected number of available processing cores. You can use this value
in your own configuration file to avoid having to set it manually.
</para></tip>

<example xml:id="make-options-example">
<title>Configuring Make to use all available CPUs, with exceptions</title>
<screen>
global
    # This environment variable is automatically used by make, including
    # make commands not run by kdesrc-build directly, such as Qt's configure
    set-env MAKEFLAGS -j<literal>${num-cores}</literal>
    â€¦
end global

â€¦

module-set <replaceable>big-module-set</replaceable>
    repository kde-projects
    use-modules <replaceable>calligra</replaceable>
    make-options -j2 # Reduced number of build jobs for just these modules
end module-set
</screen>
</example>

<note><para>Some very large Git repositories may swamp your system if you try to
compile with a too many build jobs at one time, especially repositories like the
<trademark class="trade">Qt</trademark> WebKit and <trademark class="trade">Qt</trademark> WebEngine repositories.  To maintain system interactivity
you may have to reduce the number of build jobs for specific modules.</para>
<para><xref linkend="make-options-example"/> gives an example of how to do
this.</para>
</note>

</listitem>
</itemizedlist>

<para>You may want to select different modules to build,
which is described in <xref linkend="selecting-modules"/>.</para>

</section>

<section xml:id="building-and-troubleshooting">
<title>Using the <application>kdesrc-build</application> script</title>
<para>With the configuration data established, now you are ready to run the
script.  Even if you still have some tweaking or other reading you wish to do,
it is a good idea to at least load the <orgname class="nonprofit">KDE</orgname> project metadata.</para>

<section xml:id="loading-kdesrc-build-metadata">
<title>Loading project metadata</title>

<para>
From a terminal window, log in to the user you are using to compile <orgname class="nonprofit">KDE</orgname> software and
execute the script:
</para>
<screen>
    <prompt>%</prompt> <userinput><command>kdesrc-build</command> <option>--metadata-only</option></userinput>
</screen>

<para>This command will setup the source directory and connect to the KDE <application>Git</application>
repositories to download the database of <orgname class="nonprofit">KDE</orgname> git repositories, and the
database of dependency metadata, without making any further changes.  It is
useful to run this separately as this metadata is useful for other
<application>kdesrc-build</application> commands. </para>

</section>

<section xml:id="pretend-mode">
<title>Previewing what will happen when kdesrc-build runs</title>

<para>With the project metadata installed, it is possible to preview what
<application>kdesrc-build</application> will do when launched.  This can be done with the <option><link linkend="cmdline-pretend">--pretend</link></option> command line option.</para>

<screen>
    <prompt>% </prompt><command>./kdesrc-build</command> <option>--pretend</option>
</screen>

<para>You should see a message saying that some packages were successfully built (although
    nothing was actually built).  If there were no significant problems shown, you can proceed
    to actually running the script.</para>

<screen>
    <prompt>%</prompt> <userinput><command>kdesrc-build</command> <option>--stop-on-failure</option></userinput>
</screen>

<para>This command will download the appropriate source code, and build and install each module in order, but will stop if a module fails to build (due to the <option>--stop-on-failure</option> option).  Afterwards, you should see output similar to that in <xref linkend="example-build-sequence"/>:</para>

<example xml:id="example-build-sequence">
<title>Example output of a kdesrc-build run</title>
<screen>
<prompt>%</prompt> <userinput><command>kdesrc-build</command></userinput>
Updating kde-build-metadata (to branch master)
Updating sysadmin-repo-metadata (to branch master)

Building libdbusmenu-qt (1/200)
        No changes to libdbusmenu-qt source, proceeding to build.
        Compiling... succeeded (after 0 seconds)
        Installing.. succeeded (after 0 seconds)

Building taglib (2/200)
        Updating taglib (to branch master)
        Source update complete for taglib: 68 files affected.
        Compiling... succeeded (after 0 seconds)
        Installing.. succeeded (after 0 seconds)

Building extra-cmake-modules from &lt;module-set at line 32&gt; (3/200)
        Updating extra-cmake-modules (to branch master)
        Source update complete for extra-cmake-modules: 2 files affected.
        Compiling... succeeded (after 0 seconds)
        Installing.. succeeded (after 0 seconds)

        ...

Building kdevelop from kdev (200/200)
        Updating kdevelop (to branch master)
        Source update complete for kdevelop: 29 files affected.
        Compiling... succeeded (after 1 minute, and 34 seconds)
        Installing.. succeeded (after 2 seconds)

&lt;&lt;&lt;  PACKAGES SUCCESSFULLY BUILT  &gt;&gt;&gt;
Built 200 modules

Your logs are saved in /home/kde-src/kdesrc/log/2018-01-20-07
</screen>
</example>
</section>

<section xml:id="fixing-build-failures">
<title>Resolving build failures</title>

<para>
Depending on how many modules you are downloading, it is possible that
<application>kdesrc-build</application> will not succeed the first time you compile <orgname class="nonprofit">KDE</orgname> software.
Do not despair!
</para>

<para><application>kdesrc-build</application> logs the output of every command it runs. By default,
the log files are kept in <filename class="directory">~/kdesrc/log</filename>. To see what
the caused an error for a module in the last <application>kdesrc-build</application> command, usually
it is sufficient to look at <filename class="directory">~/kdesrc/log/latest/<replaceable>module-name</replaceable>/error.log</filename>.</para>

<tip><para>Perhaps the easiest way to find out what error caused a module to
fail to build is to search backward with a case-insensitive search, starting
from the end of the file looking for the word <literal>error</literal>.  Once
that is found, scroll up to make sure there are no other error messages nearby.
The first error message in a group is usually the underlying
problem.</para></tip>

<para>In that file, you will see the error that caused the build to fail for
that module. If the file says (at the bottom) that you are missing some
packages, try installing the package (including any appropriate -dev packages)
before trying to build that module again. Make sure that when you run
<application>kdesrc-build</application> again to pass the <link linkend="cmdline-reconfigure">--reconfigure</link> option so that
<application>kdesrc-build</application> forces the module to check for the missing packages
again.</para>

<para>Or, if the error appears to be a build error (such as a syntax error,
<quote>incorrect prototype</quote>, <quote>unknown type</quote>, or similar)
then it is probably an error with the <orgname class="nonprofit">KDE</orgname> source, which will hopefully be
resolved within a few days. If it is not resolved within that time, feel free
to mail the <email>kde-devel@kde.org</email> mailing list (subscription may be
required first) in order to report the build failure.</para>

<para>You can find more common examples of things that can go wrong and their
solutions, as well as general tips and strategies to build <orgname class="nonprofit">KDE</orgname> software in the
<link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://community.kde.org/Guidelines_and_HOWTOs/Build_from_source">
Build from Source</link>.
</para>

<para>On the other hand, assuming everything went well, you should have a new
<orgname class="nonprofit">KDE</orgname> install on your computer, and now it is simply a matter of running
it, described next in <xref linkend="environment"/>.</para>

<note><para>For more information about <application>kdesrc-build</application>'s logging features,
please see <xref linkend="kdesrc-build-logging"/>.</para></note>
</section>

</section>

<section xml:id="building-specific-modules">
<title>Building specific modules</title>

<para>Rather than building every module all the time, you may only want to build a single
    module, or other small subset.  Rather than editing your configuration file, you can simply
    pass the names of modules or module sets to build to the command line.</para>

<example xml:id="example-subset-build">
<title>Example output of a kdesrc-build specific module build</title>
<screen>
    <prompt>%</prompt> <userinput><command>kdesrc-build</command> <option>--include-dependencies</option> <replaceable>dolphin</replaceable></userinput>
Updating kde-build-metadata (to branch master)
Updating sysadmin-repo-metadata (to branch master)

Building extra-cmake-modules from frameworks-set (1/79)
        Updating extra-cmake-modules (to branch master)
        No changes to extra-cmake-modules source, proceeding to build.
        Running cmake...
        Compiling... succeeded (after 0 seconds)
        Installing.. succeeded (after 0 seconds)

Building phonon from phonon (2/79)
        Updating phonon (to branch master)
        No changes to phonon source, proceeding to build.
        Compiling... succeeded (after 0 seconds)
        Installing.. succeeded (after 0 seconds)

Building attica from frameworks-set (3/79)
        Updating attica (to branch master)
        No changes to attica source, proceeding to build.
        Compiling... succeeded (after 0 seconds)
        Installing.. succeeded (after 0 seconds)

        ...

Building dolphin from base-apps (79/79)
        Updating dolphin (to branch master)
        No changes to dolphin source, proceeding to build.
        Compiling... succeeded (after 0 seconds)
        Installing.. succeeded (after 0 seconds)

&lt;&lt;&lt;  PACKAGES SUCCESSFULLY BUILT  &gt;&gt;&gt;
Built 79 modules

Your logs are saved in /home/kde-src/kdesrc/log/2018-01-20-07
</screen>
</example>

<para>In this case, although only the <replaceable>dolphin</replaceable>
application was specified, the <option>--include-dependencies</option> flag
caused <application>kdesrc-build</application> to include the dependencies listed for
<replaceable>dolphin</replaceable> (by setting the <link linkend="conf-include-dependencies">include-dependencies</link> option).
</para>

<note><para>The dependency resolution worked in this case only because
<replaceable>dolphin</replaceable> happened to be specified in a
<literal>kde-projects</literal>-based module set (in this example, named
<literal>base-apps</literal>). See <xref linkend="module-sets-kde"/>.
</para></note>

</section>

<section xml:id="environment">
<title>Setting the Environment to Run Your <orgname class="nonprofit">KDE</orgname> <productname>Plasma</productname> Desktop</title>

<para>
Assuming you are using a dedicated user to build <orgname class="nonprofit">KDE</orgname> <productname>Plasma</productname>, and you already have an
installed <productname>Plasma</productname> version, running your new <productname>Plasma</productname> may be a bit tricky, as the new
<productname>Plasma</productname> has to take precedence over the old. You must change the environment
variables of your login scripts to make sure the newly-built desktop is used.
</para>

<section xml:id="session-driver">
<title>Automatically installing a login driver</title>

<para>Starting from version 1.16, <application>kdesrc-build</application> will try to install an
appropriate login driver, that will allow you to login to your
<application>kdesrc-build</application>-built <orgname class="nonprofit">KDE</orgname> desktop from your login manager. This can be
disabled by using the <option><link linkend="conf-install-session-driver">install-session-driver</link></option>
configuration file option.</para>

<note><para>Session setup does not occur while <application>kdesrc-build</application> is running
in pretend mode.</para></note>

<para>This driver works by setting up a custom <quote><literal>xsession</literal></quote>
session type. This type of session should work by default with the <application>kdm</application> login
manager (where it appears as a <quote>Custom</quote> session), but other login
managers (such as <application>LightDM</application> and
<application>gdm</application>) may require additional files installed to
enable <literal>xsession</literal> support.</para>

<section xml:id="xsession-distribution-setup">
<title>Adding xsession support for distributions</title>

<para>The default login managers for some distributions may require additional
packages to be installed in order to support <literal>xsession</literal> logins.</para>

<itemizedlist>
<listitem><para>The <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://getfedora.org/">Fedora</link>
<trademark class="registered">Linux</trademark> distribution requires the <literal>xorg-x11-xinit-session</literal>
package to be installed for custom <literal>xsession</literal> login
support.</para></listitem>

<listitem><para><link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.debian.org/">Debian</link> and
Debian-derived <trademark class="registered">Linux</trademark> distributions should support custom
<literal>xsession</literal> logins, but require the
<option><userinput>allow-user-xsession</userinput></option> option to be set in
<filename>/etc/X11/Xsession.options</filename>. See also the Debian <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.debian.org/doc/manuals/debian-reference/ch07.en.html#_customizing_the_x_session_classic_method">documentation
on customizing the X session.</link></para></listitem>

<listitem><para>For other distributions, go to <xref linkend="xsession-manual-setup"/>.</para></listitem>
</itemizedlist>

</section>

<section xml:id="xsession-manual-setup">
<title>Manually adding support for xsession</title>

<para>If there were no distribution-specific directions for your distribution
in <xref linkend="xsession-distribution-setup"/>, you can manually add a
<quote>Custom xsession login</quote> entry to your distribution's list of
session types as follows:</para>

<procedure xml:id="proc-adding-xsession-type">
<title>Adding an .xsession login session type.</title>

<note><para>This procedure will likely require administrative privileges to
complete.
</para></note>

<step performance="required">
<para>Create the file
<filename>/usr/share/xsessions/kdesrc-build.desktop</filename>.</para>
</step>

<step performance="required">
<para>Ensure the file just created has the following text:</para>
<programlisting>Type=XSession
Exec=<co xml:id="session-homedir"/><replaceable>$HOME</replaceable>/.xsession
Name=KDE Plasma Desktop (unstable; kdesrc-build)</programlisting>

<calloutlist>
<callout arearefs="session-homedir"><para>
The <replaceable>$HOME</replaceable> entry must be replaced by the full path to
your home directory (example, <filename class="directory">/home/<replaceable>user</replaceable></filename>).  The
desktop entry specification does not allow for user-generic files.
</para></callout>

</calloutlist>
</step>

<step performance="optional"><para>When the login manager is restarted, it
should show a new session type, <quote>KDE Plasma Desktop (unstable;
kdesrc-build)</quote> in its list of sessions, which should try to run the
<filename>.xsession</filename> file installed by <application>kdesrc-build</application> if it is
selected when you login.</para>

<note><para>It may be easiest to restart the computer to restart the login
manager, if the login manager does not track updates to the <filename class="directory">/usr/share/xsessions</filename> directory.</para></note>

</step>

</procedure>

</section>

</section>

<section xml:id="old-profile-instructions">
<title>Setting up the environment manually</title>
<para>This documentation used to include instruction on which environment
variables to set in order to load up the newly-built desktop. These
instructions have been moved to an appendix (<xref linkend="old-profile-setup"/>).</para>

<para>If you intend to setup your own login support you can consult that
appendix or view the <filename>sample-kde-env-master.sh</filename> file
included with the <application>kdesrc-build</application> source.</para>

</section>

</section>

<section xml:id="kde-modules-and-selection">
<title>Module Organization and selection</title>

<section xml:id="kde-layers">
<title>KDE Software Organization</title>

<para>
<orgname class="nonprofit">KDE</orgname> software is split into different components, many of which can be built
by <application>kdesrc-build</application>. Understanding this organization will help you properly
select the software modules that you want built.
</para>

<orderedlist>
<listitem><para>At the lowest level comes the <trademark class="trade">Qt</trademark> library, which is a
very powerful, cross-platform <quote>toolkit</quote> library. <orgname class="nonprofit">KDE</orgname> is based on
<trademark class="trade">Qt</trademark>, and some of the non-<orgname class="nonprofit">KDE</orgname> libraries required by <orgname class="nonprofit">KDE</orgname> are also based on
<trademark class="trade">Qt</trademark>. <application>kdesrc-build</application> can build <trademark class="trade">Qt</trademark>, or use the one already installed on your
system if it is a recent enough version.</para></listitem>

<listitem><para>On top of <trademark class="trade">Qt</trademark> are required libraries that are necessary for
<orgname class="nonprofit">KDE</orgname> software to work. Some of these libraries are not considered part of
<orgname class="nonprofit">KDE</orgname> itself due to their generic nature, but are still essential to the <orgname class="nonprofit">KDE</orgname>
Platform. These libraries are collected under a <literal>kdesupport</literal>
module grouping but are not considered part of the <quote>Frameworks</quote>
libraries.</para>
</listitem>

<listitem><para>On top of these essential libraries come the <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://community.kde.org/Frameworks"><orgname class="nonprofit">KDE</orgname> Frameworks</link>, sometimes
abbreviated as KF5, which are essential libraries for the <orgname class="nonprofit">KDE</orgname> Plasma desktop,
<orgname class="nonprofit">KDE</orgname> Applications, and other third-party software.
</para> </listitem>

<listitem><para>On top of the Frameworks, come several different things:</para>
    <itemizedlist>
        <listitem><para><quote>Third-party</quote> applications. These are
        applications that use the <orgname class="nonprofit">KDE</orgname> Frameworks or are designed to run under
        <orgname class="nonprofit">KDE</orgname> Plasma but are not authored by or in association with the <orgname class="nonprofit">KDE</orgname>
        project.</para></listitem>

        <listitem><para>Plasma, which is a full <quote>workspace</quote> desktop
        environment. This is what users normally see when they <quote>log-in to
        <orgname class="nonprofit">KDE</orgname></quote>.</para></listitem>

        <listitem><para>The <orgname class="nonprofit">KDE</orgname> Application suite. This is a collection of
        useful software included with the Platform and <productname>Plasma</productname> Desktop, grouped into
        individual modules, including utilities like <application>Dolphin</application>, games like
        <application>KSudoku</application>, and productivity software released by <orgname class="nonprofit">KDE</orgname>
        such as <application>Kontact</application>.</para></listitem>

        <listitem><para>Finally, there is a collection of software (also
        collected in modules) whose development is supported by <orgname class="nonprofit">KDE</orgname> resources
        (such as translation, source control, bug tracking, <abbrev>etc.</abbrev>) but is not
        released by <orgname class="nonprofit">KDE</orgname> as part of Plasma or the Application suite. These
        modules are known as <quote>Extragear</quote>.
        </para></listitem>
    </itemizedlist>
</listitem>
</orderedlist>
</section>

<section xml:id="selecting-modules">
<title>Selecting modules to build</title>

<para>Selecting which of the possible modules to build is controlled by
<link linkend="kdesrc-buildrc">the configuration file</link>.
After the <literal>global</literal> section is a list of modules to build,
bracketed by module ... end module lines. An example entry for a module is
shown in <xref linkend="conf-module-example"/>.</para>

<example xml:id="conf-module-example">
<title>Example module entry in the configuration file</title>
<programlisting>
module <replaceable>kdesrc-build-git</replaceable>
    # Options for this module go here, example:
    <link linkend="conf-repository">repository</link> kde:kdesrc-build
    <link linkend="conf-make-options">make-options</link> -j4 # Run 4 compiles at a time
end module
</programlisting>
</example>

<note><para>In practice, this module construct is not usually used directly.  Instead
most modules are specified via module-sets as described below.</para></note>

<para>When using only <literal>module</literal> entries, <application>kdesrc-build</application> builds them in the order
you list, and does not attempt to download any other repositories other than what you specify
directly.
</para>

</section>

<section xml:id="module-sets">
<title>Module Sets</title>

<para>The <orgname class="nonprofit">KDE</orgname> source code is decomposed into a great number of relatively
small Git-based repositories. To make it easier to manage the large number of
repositories involved in any useful <orgname class="nonprofit">KDE</orgname>-based install, <application>kdesrc-build</application> supports
grouping multiple modules and treating the group as a <quote>module set</quote>.
</para>

<section xml:id="module-set-concept">
<title>The basic module set concept</title>

<para>By using a module set, you can quickly declare many Git modules to be
downloaded and built, as if you'd typed out a separate module declaration for
each one. The <link linkend="conf-repository">repository</link> option is
handled specially to setup where each module is downloaded from, and every
other option contained in the module set is copied to every module generated
in this fashion.</para>

<example xml:id="example-using-module-sets">
<title>Using module sets</title>
<programlisting>
global
    <option><link linkend="conf-git-repository-base">git-repository-base</link></option> <replaceable>kde-git</replaceable> <replaceable>kde:</replaceable>
end global

module <replaceable>qt</replaceable>
    # Options removed for brevity
end module

module-set <replaceable>kde-support-libs</replaceable>
    <option><link linkend="conf-repository">repository</link></option> <replaceable>kde-git</replaceable>
    <option><link linkend="conf-use-modules">use-modules</link></option> <replaceable>automoc</replaceable> <replaceable>attica</replaceable> <replaceable>akonadi</replaceable>
end module-set

# Other modules as necessary...
module <replaceable>kdesupport</replaceable>
end module
</programlisting>
</example>

<para>In <xref linkend="example-using-module-sets"/> a brief module set is
shown.  When <application>kdesrc-build</application> encounters this module set, it acts as if, for
every module given in <option>use-modules</option>, that an individual module
has been declared, with its <option>repository</option> equal to the
module-set's <option>repository</option> followed immediately by the given
module name.</para>

<para>In addition, other options can be passed in a module set, which are
copied to every new module that is created this way. By using module-set it is
possible to quickly declare many Git modules that are all based on the same
repository URL. In addition, it is possible to give module-sets a name (as shown
in the example), which allows you to quickly refer to the entire group of
modules from the command line.</para>

</section>
<section xml:id="module-sets-kde">
<title>Special Support for KDE module sets</title>

<para>The module set support described so far is general to any Git-based
modules. For the <orgname class="nonprofit">KDE</orgname> Git repositories, <application>kdesrc-build</application> includes additional
features to make things easier for users and developers.  This support is
enabled by specifying <literal>kde-projects</literal> as the
<option>repository</option> for the module set.
</para>

<para><application>kdesrc-build</application> normally only builds the modules you have listed in your
configuration file, in the order you list them.  But with a
<literal>kde-projects</literal> module set, <application>kdesrc-build</application> can do dependency
resolution of <orgname class="nonprofit">KDE</orgname>-specific modules, and in addition automatically include
modules into the build even if only indirectly specified.</para>

<example xml:id="example-using-kde-module-sets">
<title>Using kde-projects module sets</title>
<programlisting>
# Only adds a module for juk (the kde/kdemultimedia/juk repo)
module-set <replaceable>juk-set</replaceable>
    <option>repository</option> kde-projects
    <option>use-modules</option> <replaceable>juk</replaceable>
end module-set

# Adds all modules that are in kde/multimedia/*, including juk,
# but no other dependencies
module-set <replaceable>multimedia-set</replaceable>
    <option>repository</option> kde-projects
    <option>use-modules</option> <replaceable>kde/multimedia</replaceable>
end module-set

# Adds all modules that are in kde/multimedia/*, and all kde-projects
# dependencies from outside of kde/kdemultimedia
module-set <replaceable>multimedia-deps-set</replaceable>
    <option>repository</option> kde-projects
    <option>use-modules</option> <replaceable>kde/multimedia</replaceable>
    <option>include-dependencies</option> <replaceable>true</replaceable>
end module-set

# All modules created out of these three module sets are automatically put in
# proper dependency order, regardless of the setting for include-dependencies
</programlisting>
</example>

<tip><para>This <literal>kde-projects</literal> module set construct is the main method
of declaring which modules you want to build.</para></tip>

<para>All module sets use the <link linkend="conf-repository">repository</link>
and <link linkend="conf-use-modules">use-modules</link> options.  <link linkend="kde-projects-module-sets"><literal>kde-projects</literal></link> module
sets have a predefined <option>repository</option> value, but other types of
module sets also will use the <link linkend="conf-git-repository-base">git-repository-base</link> option.
</para>
</section>

</section>

<section xml:id="kde-projects-module-sets">
<title>The official <orgname class="nonprofit">KDE</orgname> module database</title>

<para><orgname class="nonprofit">KDE</orgname>'s Git repositories allow for grouping related Git modules into
collections of related modules (e.g. kdegraphics). Git doesn't recognize these
groupings, but <application>kdesrc-build</application> can understand these groups, using <link linkend="module-sets">module sets</link> with a <option>repository</option>
option set to <quote><literal>kde-projects</literal></quote>.</para>

<para><application>kdesrc-build</application> will recognize that the <literal>kde-projects</literal>
repository requires special handling, and adjust the build process
appropriately.  Among other things, <application>kdesrc-build</application> will:</para>

<itemizedlist>

<listitem><para>Download the latest module database from the <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href=" https://commits.kde.org/"><orgname class="nonprofit">KDE</orgname> git archive</link>.</para></listitem>

<listitem><para>Try to find a module with the name given in the module set's
<option>use-modules</option> setting in that database.</para></listitem>

<listitem><para>For every module that is found, <application>kdesrc-build</application> will lookup the
appropriate repository in the database, based upon the <link linkend="conf-branch-group">branch-group</link> setting in effect.  If a
repository exists and is active for the branch group, <application>kdesrc-build</application> will
automatically use that to download or update the source code.
</para></listitem>

</itemizedlist>

<note><para>In the current database, some module groups not only have a
collection of modules, but they <emphasis>also</emphasis> declare their own
<application>Git</application> repository. In these situations <application>kdesrc-build</application> will currently prefer the
group's <application>Git</application> repository instead of including the childrens' repositories.
</para></note>

<para>The following example shows how to use the <orgname class="nonprofit">KDE</orgname> module database to
install the Phonon multimedia library.</para>

<informalexample>
<programlisting>
module-set <replaceable>media-support</replaceable>
    # This option must be kde-projects to use the module database.
    <option><link linkend="conf-repository">repository</link></option> <literal>kde-projects</literal>

    # This option chooses what modules to look for in the database.
    <option><link linkend="conf-use-modules">use-modules</link></option> <replaceable>phonon/phonon</replaceable> <replaceable>phonon-gstreamer</replaceable> <replaceable>phonon-vlc</replaceable>
end module-set
</programlisting>
</informalexample>

<tip><para><literal>phonon/phonon</literal> is used since (with the current
project database) <application>kdesrc-build</application> would otherwise have to decide between the
group of projects called <quote>phonon</quote> or the individual project named
<quote>phonon</quote>. Currently <application>kdesrc-build</application> would pick the former, which
would build many more backends than needed.</para></tip>

<para>The following example is perhaps more realistic, and shows a feature only
available with the <orgname class="nonprofit">KDE</orgname> module database: Building all of the <orgname class="nonprofit">KDE</orgname> graphics
applications with only a single declaration.</para>

<informalexample>
<programlisting>
module-set <replaceable>kdegraphics</replaceable>
    # This option must be kde-projects to use the module database.
    <option><link linkend="conf-repository">repository</link></option> <literal>kde-projects</literal>

    # This option chooses what modules to look for in the database.
    <option><link linkend="conf-use-modules">use-modules</link></option> <literal>kdegraphics/libs</literal> <literal>kdegraphics/*</literal>
end module-set
</programlisting>
</informalexample>

<para>There are two important abilities demonstrated here:</para>

<orderedlist>

<listitem><para><application>kdesrc-build</application> allows you to specify modules that are
descendents of a given module, without building the parent module, by using the
syntax <userinput><replaceable>module-name</replaceable>/*</userinput>. It is
actually required in this case since the base module, kdegraphics, is marked as
inactive so that it is not accidentally built along with its children modules.
Specifying the descendent modules allows <application>kdesrc-build</application> to skip around the
disabled module.
</para></listitem>

<listitem><para><application>kdesrc-build</application> will also not add a given module to the build
list more than once. This allows us to manually set
<literal>kdegraphics/libs</literal> to build first, before the rest of
<literal>kdegraphics</literal>, without trying to build
<literal>kdegraphics/libs</literal> twice.  This used to be required for proper
dependency handling, and today remains a fallback option in case the <orgname class="nonprofit">KDE</orgname>
project database is missing dependency metadata.
</para></listitem>
</orderedlist>
</section>

<section xml:id="ignoring-project-modules">
<title>Filtering out <orgname class="nonprofit">KDE</orgname> project modules</title>

<para>You might decide that you'd like to build all programs within a <orgname class="nonprofit">KDE</orgname>
module grouping <emphasis>except</emphasis> for a given program.</para>

<para>For instance, the <literal>kdeutils</literal> group includes a program
named <application>kremotecontrol</application>. If your computer does not have
the proper hardware to receive the signals sent by remote controls then you may
decide that you'd rather not download, build, and install
<application>kremotecontrol</application> every time you update
<literal>kdeutils</literal>.</para>

<para>You can achieve this by using the <link linkend="conf-ignore-modules">ignore-modules</link> configuration option.
On the command line the
<link linkend="ignoring-modules"><link linkend="cmdline-ignore-modules">--ignore-modules</link> option</link>
does the same thing, but is more convenient for filtering out a module just once.
</para>

<example xml:id="example-ignoring-a-module">
<title>Example for ignoring a kde-project module in a group</title>
<programlisting>
module-set <replaceable>utils</replaceable>
    <option><link linkend="conf-repository">repository</link></option> <literal>kde-projects</literal>

    # This option chooses what modules to look for in the database.
    <option><link linkend="conf-use-modules">use-modules</link></option> <replaceable>kdeutils</replaceable>

    # This option "subtracts out" modules from the modules chosen by use-modules, above.
    <option><link linkend="conf-ignore-modules">ignore-modules</link></option> <replaceable>kremotecontrol</replaceable>
end module-set

module-set <replaceable>graphics</replaceable>
    <option><link linkend="conf-repository">repository</link></option> <literal>kde-projects</literal>

    # This option chooses what modules to look for in the database.
    <option><link linkend="conf-use-modules">use-modules</link></option> <replaceable>extragear/graphics</replaceable>

    # This option "subtracts out" modules from the modules chosen by use-modules, above.
    # In this case, *both* extragear/graphics/kipi-plugins and
    # extragear/graphics/kipi-plugins/kipi-plugins-docs are ignored
    <option><link linkend="conf-ignore-modules">ignore-modules</link></option> <replaceable>extragear/graphics/kipi-plugins</replaceable>
end module-set
</programlisting>
</example>

</section>

</section>

<section xml:id="quick-start-conclusion">
<title>Getting Started Conclusion</title>
<para>These are the major features and concepts needed to get started with
<application>kdesrc-build</application></para>

<para>For additional information, you could keep reading through this
documentation. In particular, the <link linkend="supported-cmdline-params">list
of command-line options</link> and the <link linkend="conf-options-table">table
of configuration file options</link> are useful references.</para>

<para>The <orgname class="nonprofit">KDE</orgname> Community also maintains <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://community.kde.org/Guidelines_and_HOWTOs/Build_from_source">an
online Wiki reference for how to build the source code</link>, which refers to
<application>kdesrc-build</application> and includes tips and other guidelines on how to use the
tool.</para>

</section>

</chapter>

<chapter xml:id="features">
<title>Script Features</title>

<section xml:id="features-overview">
<title>Feature Overview</title>

<para>
<application>kdesrc-build</application> features include:
</para>

<itemizedlist>

<listitem><para>
You can <quote>pretend</quote> to do the operations. If you pass
<option>--pretend</option> or <option>-p</option> on the
command line, the script will give a verbose description of the commands
it is about to execute, without actually executing it. However if you've never
run <application>kdesrc-build</application>, you would want to run the <command>kdesrc-build
<option><link linkend="cmdline-metadata-only">--metadata-only</link></option></command>
command first in order for <option>--pretend</option> to work.

<tip><para>For an even more verbose description of what <application>kdesrc-build</application> is
doing, try using the <option>--debug</option> option.
</para></tip>

</para></listitem>

<listitem><para>
<application>kdesrc-build</application> can (with the assistance of the <orgname class="nonprofit">KDE</orgname> FTP server) allow for
speedy checkouts of
some Subversion modules. If the module you are checking out has already been
packaged at the website, then <application>kdesrc-build</application> will download the snapshot and
prepare it for use on your computer.
</para>

<tip><para>There is generally no need for any special preparation to perform
the initial checkout of a Git module, as the entire Git repository must be
downloaded anyways, so it is easy for the server to determine what to
send.</para></tip>

<para>This is faster for you, and helps to ease the load on the kde.org
anonymous <application>Subversion</application> servers.</para>
</listitem>

<listitem><para>
Another speedup is provided by starting the build process for a module as soon
as the source code for that module has been downloaded.  (Available since
version 1.6)
</para></listitem>

<listitem><para>
Excellent support for building the <trademark class="trade">Qt</trademark> library (in case the <orgname class="nonprofit">KDE</orgname> software you
are trying to build depends on a recent <trademark class="trade">Qt</trademark> not available in your
distribution).
</para></listitem>

<listitem><para>
<application>kdesrc-build</application> does not require a <acronym>GUI</acronym> present to operate. So,
you can build <orgname class="nonprofit">KDE</orgname> software without needing a graphical environment.
</para></listitem>

<listitem><para>
Supports setting default options for all modules (such as the compilation
settings or the configuration options). Such options can normally be changed
for specific modules as well.</para>

<para>Also, <application>kdesrc-build</application> will <link linkend="kdesrc-build-std-flags">add
standard flags</link> as appropriate to save you the trouble and possible
errors from typing them yourself. Nota Bene: this does not apply when a (custom)
toolchain is configured through e.g.:
<link linkend="conf-cmake-toolchain">cmake-toolchain</link>
</para></listitem>

<listitem><para>
<application>kdesrc-build</application> can checkout a specific <link linkend="using-branches">branch
or tag</link> of a module. You can also ensure that a specific <link linkend="conf-revision">revision</link> is checked out of a module.
</para></listitem>

<listitem><para>
<application>kdesrc-build</application> can automatically switch a source directory to checkout from
a different repository, branch, or tag. This happens automatically when you
change an option that changes what the repository <acronym>URL</acronym> should be, but you must
use the <link linkend="cmdline-src-only">--src-only</link> option to let
<application>kdesrc-build</application> know that it is acceptable to perform the switch.
</para></listitem>

<listitem><para>
<application>kdesrc-build</application> can <link linkend="partial-builds">checkout only portions of a
module</link>, for those situations where you only need one program from a
large module.
</para></listitem>

<listitem><para>
For developers: <application>kdesrc-build</application> will <link linkend="ssh-agent-reminder">remind
you</link> if you use svn+ssh:// but <application>ssh-agent</application> is
not running, as this will lead to repeated password requests from
<application>SSH</application>.
</para></listitem>

<listitem><para>
Can <link linkend="deleting-build-dir">delete the build directory</link> of a
module after its installation to save space at the expense of future compilation
time.
</para></listitem>

<listitem><para>
The locations for the directories used by <application>kdesrc-build</application> are configurable (even
per module).
</para></listitem>

<listitem><para>
Can use <application>Sudo</application>, or a different user-specified command
to <link linkend="root-installation">install modules</link> so that
<application>kdesrc-build</application> does not need to be run as the super user.
</para></listitem>

<listitem><para>
<application>kdesrc-build</application> runs <link linkend="build-priority">with reduced priority</link>
by default to allow you to still use your computer while <application>kdesrc-build</application> is
working.
</para></listitem>

<listitem><para>
Has support for using <orgname class="nonprofit">KDE</orgname>'s <link linkend="using-branches">tags and
branches</link>.
</para></listitem>

<listitem><para>
There is support for <link linkend="resuming">resuming a build</link> from a
given module. You can even <link linkend="ignoring-modules">ignore some
modules</link> temporarily for a given build.
</para></listitem>

<listitem><para>
<application>kdesrc-build</application> will show the <link linkend="build-progress">progress of your
build</link> when using <application>CMake</application>, and will always time the build
process so you know after the fact how long it took.
</para></listitem>

<listitem><para>
Comes built-in with a sane set of default options appropriate for building
a base <orgname class="nonprofit">KDE</orgname> single-user installation from the anonymous source repositories.
</para></listitem>

<listitem><para>
Tilde-expansion for your configuration options. For example, you can
specify:
<programlisting>qtdir ~/kdesrc/build/qt</programlisting>
</para></listitem>

<listitem><para>
Automatically sets up a build system, with the source directory not the
same as the build directory, in order to keep the source directory
pristine.
</para></listitem>

<listitem><para>
You can specify global options to apply to every module to check out, and
you can specify options to apply to individual modules as well.
</para></listitem>

<listitem><para>
Forced full rebuilds, by running
<application>kdesrc-build</application> with the <option>--refresh-build</option> option.
</para></listitem>

<listitem><para>
You can specify various environment values to be used during the build,
including <envar>KDEDIR</envar>, <envar>QTDIR</envar>, <envar>DO_NOT_COMPILE</envar>,
and <envar>CXXFLAGS</envar>.
</para></listitem>

<listitem><para>
Command logging. Logs are dated and numbered so that you always have a
log of a script run. Also, a special symlink called latest is created to
always point to the most recent log entry in the log directory.
</para></listitem>

<listitem><para>
You can check out only a portion of a <orgname class="nonprofit">KDE</orgname> <application>Subversion</application> module. For example,
you could check out only the <application>taglib</application> from
<application>kdesupport</application>.
</para></listitem>

</itemizedlist>

</section>

<section xml:id="kdesrc-build-logging">
<title><application>kdesrc-build</application>'s build logging</title>

<section xml:id="logging-overview">
<title>Logging overview</title>

<para>Logging is a <application>kdesrc-build</application> feature whereby the output from every command
that <application>kdesrc-build</application> runs is saved to a file for examination later, if
necessary. This is done because it is often necessary to have the output of
these programs when there is a build failure, because there are so many
reasons why a build can fail in the first place.</para>

<section xml:id="log-directory-layout">
<title>Logging directory layout</title>

<para>The logs are always stored under the log directory. The destination of
the log directory is controlled by the <link linkend="conf-log-dir">log-dir</link>
option, which defaults to <filename class="directory"><symbol>${source-dir}</symbol>/log</filename> (where
<symbol>${source-dir}</symbol> is the value of the <link linkend="conf-source-dir">source-dir</link>
option. The in rest of this section, this value will be referred to as
<symbol>${log-dir}</symbol>).</para>

<para>Under <symbol>${log-dir}</symbol>, is a set of directories, one for every
time that <application>kdesrc-build</application> was run. Each directory is named with the date, and
the run number. For instance, the second time that <application>kdesrc-build</application> is run on
May 26, 2004, it would create a directory called <filename>2004-05-26-02</filename>,
where the 2004-05-26 is for the date, and the -02 is the run number.</para>

<para>For your convenience, <application>kdesrc-build</application> will also create a link to the
logs for your latest run, called <filename class="directory">latest</filename>. So the logs for
the most recent <application>kdesrc-build</application> run should always be under <filename class="directory"><symbol>${log-dir}</symbol>/latest</filename>.
</para>

<para>Now, each directory for a <application>kdesrc-build</application> run will itself contain a set of
directories, one for every <orgname class="nonprofit">KDE</orgname> module that <application>kdesrc-build</application> tries to build. Also,
a file called <filename>build-status</filename> will be contained in the directory,
which will allow you to determine which modules built and which failed.</para>

<note><para>
If a module itself has a submodule (such as extragear/multimedia,
playground/utils, or KDE/kdelibs), then there would actually be a matching
layout in the log directory. For example, the logs for KDE/kdelibs after the
last <application>kdesrc-build</application> run would be found in <filename class="directory"><symbol>${log-dir}</symbol>/latest/KDE/kdelibs</filename>,
and not under <filename class="directory"><symbol>${log-dir}</symbol>/latest/kdelibs</filename>.
</para></note>

<para>In each module log directory, you will find a set of files for each
operation that <application>kdesrc-build</application> performs. If <application>kdesrc-build</application> updates a module,
you may see filenames such as <filename>svn-co.log</filename> (for a
module checkout) or <filename>svn-up.log</filename> (when updating a module
that has already been checked out). If the <command>configure</command>
command was run, then you would expect to see a <filename>configure.log</filename>
in that directory.</para>

<para>If an error occurred, you should be able to see an explanation of why in
one of the files. To help you determine which file contains the error,
<application>kdesrc-build</application> will create a link from the file containing the error (such as
<filename>build-1.log</filename> to a file called <filename>error.log</filename>).</para>

<para>The upshot to all of this is that to see why a module failed to build
after your last <application>kdesrc-build</application>, the file you should look at first is
<filename><symbol>${log-dir}</symbol>/latest/<replaceable>module-name</replaceable>/error.log</filename>.
</para>

<tip><para>If the file <filename>error.log</filename> is empty (especially after
an installation), then perhaps there was no error. Some of the tools used by
the <orgname class="nonprofit">KDE</orgname> build system will sometimes mistakenly report an error when there was
none.</para>

<para>Also, some commands will evade <application>kdesrc-build</application>'s output redirection and
bypass the log file in certain circumstances (normally when performing the
first <application>Subversion</application> checkout), and the error output in that case is not in the log file
but is instead at the <application>Konsole</application> or terminal where you ran <application>kdesrc-build</application>.</para>
</tip>

</section>
</section>
</section>

</chapter>

<chapter xml:id="kdesrc-buildrc">
<title>Configuring <application>kdesrc-build</application></title>

<section xml:id="kdesrc-buildrc-overview">
<title>Overview of <application>kdesrc-build</application> configuration</title>

<para>
To use the script, you must have a file in your home directory called
<filename>.kdesrc-buildrc</filename>, which describes the modules you would
like to download and build, and any options or configuration parameters to
use for these modules.
</para>

<section xml:id="kdesrc-buildrc-layout">
<title>Layout of the configuration file</title>

<section xml:id="kdesrc-buildrc-layout-global">
<title>Global configuration</title>

<para>
The configuration file starts with the global options, specified like the
following:
</para>

<programlisting>
global
<replaceable>option-name option-value</replaceable>
<replaceable>[...]</replaceable>
end global
</programlisting>

</section>
<section xml:id="kdesrc-buildrc-layout-modules">
<title>Module configuration</title>

<para>
It is then followed by one or more module sections, specified in one of the
following two forms:
</para>

<itemizedlist>
<listitem>
<programlisting>
module <replaceable>module-name</replaceable>
<replaceable>option-name option-value</replaceable>
<replaceable>[...]</replaceable>
end module
</programlisting>
</listitem>

<listitem>
<programlisting>
module-set <replaceable>module-set-name</replaceable>
  repository <userinput>kde-projects</userinput> or <userinput><replaceable>git://host.org/path/to/repo.git</replaceable></userinput>
  use-modules <replaceable>module-names</replaceable>

# Other options may also be set
<replaceable>option-name option-value</replaceable>
<replaceable>[...]</replaceable>
end module-set
</programlisting>
</listitem>
</itemizedlist>

<important><para>Note that the second form, module sets, <emphasis>only works
for Git-based modules</emphasis>.</para></important>

<para>
For Subversion modules, <replaceable>module-name</replaceable> must be a module
from the <orgname class="nonprofit">KDE</orgname> <application>Subversion</application> repository (for example, kdeartwork or
kde-wallpapers), although it is possible to get around this if you
<link linkend="conf-override-url">manually specify the <application>Subversion</application> URL</link>.
</para>

<para>
For Git modules, the module name can be essentially whatever you'd like, as
long as it does not duplicate any other module name in the configuration. Keep
in mind the source and build directory layout will be based on the module name
if you do not use the <link linkend="conf-dest-dir">dest-dir</link> option.
</para>

<para>However, for Git <emphasis>module sets</emphasis> the
<replaceable>module-names</replaceable> must correspond with actual git modules
in the chosen <option>repository</option>. See <link linkend="conf-git-repository-base">git-repository-base</link> or <link linkend="conf-use-modules">use-modules</link> for more information.
</para>

</section>

<section xml:id="kdesrc-buildrc-option-values">
<title>Processing of option values</title>

<para>In general, the entire line contents after the
<replaceable>option-name</replaceable> is used as the
<replaceable>option-value</replaceable>.</para>

<para>One modification that <application>kdesrc-build</application> performs is that a sequence
<userinput>${<replaceable>name-of-option</replaceable>}</userinput> is replaced
with the value of that option from the global configuration. This allows you
to reference the value of existing options, including options already set by
<application>kdesrc-build</application>.</para>

<para>
To see an example of this in use, see
<xref linkend="make-options-example"/>.</para>

</section>

<section xml:id="kdesrc-buildrc-options-groups">
<title><quote>options</quote> modules</title>

<para>There is a final type of configuration file entry,
<literal>options</literal> groups, which may be given wherever a
<literal>module</literal> or <literal>module-set</literal> may be used.</para>

<programlisting>
options <replaceable>module-name</replaceable>
<replaceable>option-name option-value</replaceable>
<replaceable>[...]</replaceable>
end options
</programlisting>

<para>An <literal>options</literal> group may have options set for it just like
a module declaration, and is associated with an existing module. Any options
set these way will be used to <emphasis>override</emphasis> options set for the
associated module.</para>

<important><para>The associated module name <emphasis>must</emphasis> match the
name given in the <literal>options</literal> declaration. Be careful of
mis-typing the name.</para></important>

<para>This is useful to allow for declaring an entire
<literal>module-set</literal> worth of modules, all using the same options, and
then using <literal>options</literal> groups to make individual changes.</para>

<para><literal>options</literal> groups can also apply to named module sets.
This allows expert users to use a common configuration file (which includes
<literal>module-set</literal> declarations) as a baseline, and then make changes
to the options used by those module-sets in configuration files that
use the <literal><link linkend="kdesrc-buildrc-including">include</link></literal> command to reference
the base configuration.</para>

<example xml:id="ex-options-group">
<title>Example of using options</title>

<para>In this example we choose to build all modules from the <orgname class="nonprofit">KDE</orgname> multimedia
software grouping. However we want to use a different version of the <application>KMix</application>
application (perhaps for testing a bug fix). It works as follows:</para>

<programlisting>
module-set <replaceable>kde-multimedia-set</replaceable>
  repository <userinput>kde-projects</userinput>
  use-modules <replaceable>kde/kdemultimedia</replaceable>
  branch <replaceable>master</replaceable>
end module-set

# kmix is a part of kde/kdemultimedia group, even though we never named
# kmix earlier in this file, <application>kdesrc-build</application> will figure out the change.
options <replaceable>kmix</replaceable>
  branch <replaceable>KDE/4.12</replaceable>
end options
</programlisting>

<para>Now when you run <application>kdesrc-build</application>, all of the <orgname class="nonprofit">KDE</orgname> multimedia programs will
be built from the <quote>master</quote> branch of the source repository, but
<application>KMix</application> will be built from the older <quote>KDE/4.12</quote> branch. By using
<literal>options</literal> you didn't have to individually list all the
<emphasis>other</emphasis> <orgname class="nonprofit">KDE</orgname> multimedia programs to give them the right
branch option.</para>

</example>

<note>
<para>Note that this feature is only available in <application>kdesrc-build</application> from version
1.16, or using the development version of <application>kdesrc-build</application> after
2014-01-12.</para></note>

</section>

</section>

<section xml:id="kdesrc-buildrc-including">
<title>Including other configuration files</title>

<para>
Within the configuration file, you may reference other files by using the
<literal>include</literal> keyword with a file, which will act as if the file
referenced had been inserted into the configuration file at that point.
</para>

<informalexample><para>For example, you could have something like this:</para>
<programlisting>
global
    include <replaceable>~/common-kdesrc-build-options</replaceable>

    # Insert specific options here.

end global
</programlisting>
</informalexample>

<note><para>If you don't specify the full path to the file to include, then
the file will be searched for starting from the directory containing the source
file. This works recursively as well.</para></note>

</section>

<section xml:id="kdesrc-buildrc-common">
<title>Commonly used configuration options</title>

<para>
The following is a list of commonly-used options. Click on the
option to find out more about it. To see the full list of options, see
<xref linkend="conf-options-table"/>.
</para>

<itemizedlist>
<listitem><para><link linkend="conf-cmake-options">cmake-options</link> to define what flags to configure a module with using <application>CMake</application>.</para></listitem>
<listitem><para><link linkend="conf-branch">branch</link>, to checkout from a branch instead of /trunk (for <application>Subversion</application>) or <literal>master</literal> (for Git).</para></listitem>
<listitem><para><link linkend="conf-configure-flags">configure-flags</link> to define what flags to configure <trademark class="trade">Qt</trademark> with.</para></listitem>
<listitem><para><link linkend="conf-kdedir">kdedir</link>, to set the directory to install <orgname class="nonprofit">KDE</orgname> to.</para></listitem>
<listitem><para><link linkend="conf-make-options">make-options</link>, to pass options to the <application>Make</application> program (such as number of CPUs to use).</para></listitem>
<listitem><para><link linkend="conf-qtdir">qtdir</link>, to set the path to <trademark class="trade">Qt</trademark>.</para></listitem>
<listitem><para><link linkend="conf-source-dir">source-dir</link>, to change where to download the source code to.</para></listitem>
</itemizedlist>

</section>
</section>
<section xml:id="conf-options-table">
<title>Table of available configuration options</title>

<para>Here is a table of the various options, containing the following
information:</para>

<itemizedlist>

<listitem><para>The option name</para></listitem>

<listitem><para>A description of how <application>kdesrc-build</application> responds if the option is
set in both the global section, and the module section of the <link linkend="configure-data">configuration file</link> while building a
module.</para></listitem>

<listitem><para>Special comments on the purpose and usage of the
option.</para></listitem>

</itemizedlist>

<table xml:id="option-table" colsep="1" rowsep="1" pgwide="0">
<title>Table of Options</title>
<tgroup cols="3" colsep="1" rowsep="1">

<thead>
<row>
<entry>Option-name</entry>
<entry>Module -&gt; Global Behavior</entry>
<entry>Notes</entry>
</row>
</thead>

<tbody>

<row>
<entry>apidox</entry>
<entry/>
<entry><para>This option was used to allow for building KDE module API documentation.
It was removed in <application>kdesrc-build</application> 1.6.3 due to lack of support.  Online
API documentation is available from <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://api.kde.org/">kde.org</link>.
In addition it is possible to build KDE API documentation using the
<command>kdedoxygen.sh</command> script included in the kde-dev-scripts module.
See <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://techbase.kde.org/Development/Tools/apidox">KDE
TechBase</link> for more details.</para>
</entry>
</row>

<row>
<entry>apply-qt-patches</entry>
<entry/>
<entry>This option was removed in kdesrc-build 1.10. To get the same effect,
see <xref linkend="using-qt"/> and the <link linkend="conf-repository">repository</link> option.</entry>
</row>

<row xml:id="conf-async">
<entry>async</entry>
<entry>Cannot be overridden</entry>
<entry><para>This option enables the asynchronous mode of operation, where the source
code update and the build process will be performed in parallel, instead of waiting for
all of the source code updates before starting the build process.  This option defaults
to enabling asynchronous mode.  To disable, set this option to <userinput>false</userinput></para>
<para>This option is available since the 1.6 release.</para></entry>
</row>

<row xml:id="conf-binpath">
<entry>binpath</entry>
<entry>Module setting overrides global</entry>
<entry><para>Set this option to set the environment variable PATH while building.
You cannot override this setting in a module option. The default value is
the $<envar>PATH</envar> that is set when the script starts. This environment
variable should include the colon-separated paths of your development
toolchain. The paths <filename class="directory">$<envar>KDEDIR</envar>/bin</filename> and
<filename class="directory">$<envar>QTDIR</envar>/bin</filename> are automatically added. You
may use the tilde (~) for any paths you add using this option.</para>
</entry>
</row>

<row xml:id="conf-branch">
<entry>branch</entry>
<entry>Module setting overrides global</entry>
<entry><para>Set this option to checkout from a branch of <orgname class="nonprofit">KDE</orgname> instead of the
default of <replaceable>master</replaceable> (for <application>Git</application> modules) or
<replaceable>trunk</replaceable> (for <application>Subversion</application>), where <orgname class="nonprofit">KDE</orgname> development
occurs.</para>

<para>
For instance, to checkout <orgname class="nonprofit">KDE</orgname> 4.6 branch, you would set this option to
<replaceable>4.6</replaceable>.</para>

<para>If <application>kdesrc-build</application> fails to properly download a branch with this option, you
may have to manually specify the <acronym>URL</acronym> to download from using the <link linkend="conf-module-base-path">module-base-path</link> or <link linkend="conf-override-url">override-url</link> options.</para>

<note><para>For most <orgname class="nonprofit">KDE</orgname> modules you probably wish to use the <link linkend="conf-branch-group">branch-group</link> option instead and use this
option for case-by-case exceptions.</para></note>

</entry>
</row>

<row xml:id="conf-branch-group">
<entry>branch-group</entry>
<entry>Module setting overrides global</entry>
<entry>

<para>Set this option to a general group from which you want modules to be
chosen.</para>

<para>For supported <application>Git</application> module types, <application>kdesrc-build</application> will determine the
actual branch to use automatically based on rules encoded by the <orgname class="nonprofit">KDE</orgname>
developers (these rules may be viewed in the
<literal>kde-build-metadata</literal> source repository in your source
directory). After a branch is determined that branch is used as if you had
specified it yourself using the <link linkend="conf-branch">branch</link>
option.
</para>

<para>This is useful if you're just trying to maintain up-to-date on some
normal development track without having to pay attention to all the branch name
changes.</para>

<para>The current branch groups (as of 2013-08-11) are:</para>

<itemizedlist>

<listitem><para><literal>stable-qt4</literal>, for tracking bugfixes to the
<trademark class="trade">Qt</trademark> 4-based <orgname class="nonprofit">KDE</orgname> libraries and applications.</para></listitem>

<listitem><para><literal>latest-qt4</literal>, for tracking development and new
features for the <trademark class="trade">Qt</trademark> 4-based <orgname class="nonprofit">KDE</orgname> libraries and
applications.</para></listitem>

<listitem><para><literal>kf5-qt5</literal>, for tracking
<quote>bleeding-edge</quote> development for the upcoming <trademark class="trade">Qt</trademark> 5-based <orgname class="nonprofit">KDE</orgname>
Frameworks 5, <productname>Plasma</productname> Workspace 2, <abbrev>etc.</abbrev></para></listitem>

</itemizedlist>

<para>Note that if you <emphasis>do</emphasis> choose a
<literal>branch</literal> yourself, that it will override this setting. The
same is true of other specific branch selection options such as <link linkend="conf-tag">tag</link>.</para>

<para>This option was added in <application>kdesrc-build</application> 1.16-pre2.</para>

<note><para>This option only applies to <literal>kde-projects</literal> <application>Git</application>
modules (the common case).  See also <xref linkend="kde-projects-module-sets"/>.
</para></note>

</entry>
</row>

<row xml:id="conf-build-dir">
<entry>build-dir</entry>
<entry>Module setting overrides global</entry>
<entry>Use this option to change the directory to contain the built sources. There
are three different ways to use it:

<orderedlist>

<listitem><para>Relative to the <orgname class="nonprofit">KDE</orgname> <application>Subversion</application> source directory (see <link linkend="conf-source-dir">the source-dir option</link>). This is the default,
and is selected if you type a directory name that does not start with a tilde
(~) or a slash (/).</para> <para>The default value is <filename class="directory">build</filename>.</para></listitem>

<listitem><para>Absolute path. If you specify a path that begins with a /, then
that path is used directly. For example, <filename class="directory">/tmp/kde-obj-dir/</filename>.</para></listitem>

<listitem><para>Relative to your home directory. If you specify a path that
begins with a ~, then the path is used relative to your home directory,
analogous to the shell's tilde-expansion. For example, <filename class="directory">~/builddir</filename> would set the build directory to
<filename class="directory">/home/user-name/builddir</filename>.</para></listitem>

</orderedlist>

Perhaps surprisingly, this option can be changed per module.

</entry>
</row>

<row xml:id="conf-build-when-unchanged">
<entry>build-when-unchanged</entry>
<entry>Module setting overrides global</entry>
<entry><para>Use this option in order to control whether <application>kdesrc-build</application> always
tries to build a module that has not had any source code updates.</para>

<para>By setting <option>build-when-unchanged</option> to
<userinput>true</userinput>, <application>kdesrc-build</application> always attempts the build phase
for a module, even if the module did not have any source code updates. This is
the default setting since it is more likely to lead to a correct
build.</para>

<para>By setting <option>build-when-unchanged</option> to
<userinput>false</userinput>, <application>kdesrc-build</application> will only attempt to run the
build phase for a module if the module has a source code update, or in other
situations where it is likely that a rebuild is actually required. This can save
time, especially if you run <application>kdesrc-build</application> daily, or more frequently.</para>

<important><para>This feature is provided as an optimization only. Like many
other optimizations, there are trade-offs for the correctness of your
installation. For instance, changes to the qt or kdelibs modules may cause
a rebuild of other modules to be necessary, even if the source code doesn't
change at all.</para></important>
</entry>
</row>

<row xml:id="conf-checkout-only">
<entry>checkout-only</entry>
<entry>Module setting overrides global</entry>
<entry><para>Set this option to checkout <application>Subversion</application> sources piece by piece. The
value for this option should be a space-separated list of directories to
checkout.  Although this option overrides the global option, be aware that
setting this as a global option makes no sense.
</para>

<para>Note that this setting has no effect on <application>Git</application> modules due to the
operation of the <application>Git</application> source control system.</para>

<para>See <xref linkend="checking-out-parts"/> for an example.</para></entry>
</row>

<row xml:id="conf-cmake-generator">
<entry>cmake-generator</entry>
<entry>Module setting overrides global</entry>
<entry><para>Use this option to specify which generator to use with <application>CMake</application>.
Currently both <literal>Ninja</literal> and <literal>Unix Makefiles</literal>
as well as extra generators based on them like <literal>Eclipse CDT4 - Ninja
</literal> are supported. Invalid (unsupported) values are ignored and treated
as if unset. If not set <literal>Unix Makefiles</literal> will be used by
default.
</para>

<para>Note that if a valid generator is also specified through
<link linkend="conf-cmake-options">cmake-options</link> it will override the
value for <literal>cmake-generator</literal>.</para></entry>
</row>

<row xml:id="conf-cmake-toolchain">
<entry>cmake-toolchain</entry>
<entry>Module setting overrides global</entry>
<entry><para>Use this option to specify a toolchain file to use with <application>CMake</application>.
</para>
<para>When a valid toolchain file is configured, <application>kdesrc-build</application> will
<emphasis>no longer set environment variables automatically</emphasis>.
You can use <link linkend="conf-set-env">set-env</link>, <link linkend="conf-binpath">binpath</link> and <link linkend="conf-libpath">libpath</link> to fix up the environment
manually if your toolchain file does not work out of the box with
<application>kdesrc-build</application>. Refer to <link linkend="kdesrc-build-std-flags">the overview
of standard flags added by <application>kdesrc-build</application></link> for more information.
</para>
<para>Note that if a valid toolchain is also specified through
<link linkend="conf-cmake-options">cmake-options</link> it will override the
value for <literal>cmake-toolchain</literal>.</para></entry>
</row>

<row xml:id="conf-cmake-options">
<entry>cmake-options</entry>
<entry>Appends to global options for the default buildsystem, overrides global
for other buildsystems.</entry>
<entry><para>Use this option to specify what flags to pass to <application>CMake</application> when
creating the build system for the module. When this is used as a global option,
it is applied to all modules that this script builds. When used as a module
option, it is added to the end of the global options. This allows you to
specify common <application>CMake</application> options in the global section.</para>

<para>This option does not apply to qt (which does not use <application>CMake</application>). Use
<link linkend="conf-configure-flags">configure-flags</link> instead.</para>

<para>If a valid generator is specified among the listed options it will
override the value of
<link linkend="conf-cmake-generator">cmake-generator</link>. Invalid
(unsupported) generators are ignored and will not be passed to <application>CMake</application>.
</para>

<para>If a valid toolchain file is specified among the listed options it will
override the value of
<link linkend="conf-cmake-toolchain">cmake-toolchain</link>. Invalid
toolchains are ignored and will not be passed to <application>CMake</application>.
</para>

<para>Since these options are passed directly to the <application>CMake</application> command line, they
should be given as they would be typed into <application>CMake</application>. For example:</para>

<screen>  cmake-options -DCMAKE_BUILD_TYPE=RelWithDebInfo
</screen>

<para>Since this is a hassle, <application>kdesrc-build</application> takes pains to ensure that as long
as the rest of the options are set correctly, you should be able to leave this
option blank. (In other words, <emphasis>required</emphasis> <application>CMake</application> parameters
are set for you automatically)</para></entry>
</row>

<row xml:id="conf-colorful-output">
<entry>colorful-output</entry>
<entry>Cannot be overridden</entry>
<entry>Set this option to <userinput>false</userinput> to disable the colorful output of <application>kdesrc-build</application>.
This option defaults to <replaceable>true</replaceable>. Note that <application>kdesrc-build</application> will not output the
color codes to anything but a terminal (such as xterm, <application>Konsole</application>, or the normal
<trademark class="registered">Linux</trademark> console).
</entry>
</row>

<row xml:id="conf-compile-commands-export">
<entry>compile-commands-export</entry>
<entry>Module setting overrides global</entry>
<entry>
<para>Enables the generation of a <literal>compile_commands.json</literal> via CMake inside the build directory.
This option defaults to <replaceable>true</replaceable>, set it to <userinput>false</userinput> to disable
this behavior.
</para>
</entry>
</row>

<row xml:id="conf-compile-commands-linking">
<entry>compile-commands-linking</entry>
<entry>Module setting overrides global</entry>
<entry>
<para>Enables the creation of symbolic links from <literal>compile_commands.json</literal> generated via CMake
inside the build directory to the matching source directory.
This option defaults to <replaceable>false</replaceable>, set it to <userinput>true</userinput> to enable
the automatic symbolic link creation.
</para>
</entry>
</row>

<row xml:id="conf-configure-flags">
<entry>configure-flags</entry>
<entry>Appends to global options for the default buildsystem, overrides global
for other buildsystems.</entry>
<entry><para>Use this option to specify what flags to pass to ./configure when
creating the build system for the module. When this is used as a global-option,
it is applied to all modules that this script builds. <emphasis>This option
only works for qt.</emphasis></para>

<para>To change configuration settings for KDE modules, see
<link linkend="conf-cmake-options">cmake-options</link>.
</para>
</entry>
</row>

<row xml:id="conf-custom-build-command"><entry>custom-build-command</entry>
<entry>Module setting overrides global (build system option)</entry>
<entry><para>This option can be set to run a different command (other than <command>make</command>, for example) in order to perform the build process. <application>kdesrc-build</application> should in general do the right thing, so you should not need to set this option. However it can be useful to use alternate build systems.</para><para>The value of this option is used as the command line to run, modified by the <link linkend="conf-make-options">make-options</link> option asnormal.</para></entry>
</row>

<row xml:id="conf-cxxflags">
<entry>cxxflags</entry>
<entry>Appends to global options for the default buildsystem, overrides global
for other buildsystems.</entry>
<entry><para>Use this option to specify what flags to use for building the
module. This option is
specified here instead of with <link linkend="conf-configure-flags">configure-flags</link> or <link linkend="conf-cmake-options">cmake-options</link> because this option will also
set the environment variable <envar>CXXFLAGS</envar> during the build process.</para>

<para>Note that for <orgname class="nonprofit">KDE</orgname> 4 and any other modules that use <application>CMake</application>, it is
necessary to set the CMAKE_BUILD_TYPE option to <userinput>none</userinput>
when configuring the module.  This can be done using the <link linkend="conf-cmake-options">cmake-options</link> option.
</para>
</entry>
</row>

<row xml:id="conf-dest-dir">
<entry>dest-dir</entry>
<entry>Module setting overrides global</entry>
<entry>Use this option to change the name a module is given on disk. For
example, if your module was extragear/network, you could rename it to
extragear-network using this option.  Note that although this changes the
name of the module on disk, it is not a good idea to include directories
or directory separators in the name as this will interfere with any
<link linkend="conf-build-dir">build-dir</link> or
<link linkend="conf-source-dir">source-dir</link> options.
</entry>
</row>

<row xml:id="conf-disable-agent-check">
<entry>disable-agent-check</entry>
<entry>Cannot be overridden</entry>
<entry>Normally if you are using <application>SSH</application> to download the <application>Subversion</application> sources
(such as if you are using the svn+ssh protocol), <application>kdesrc-build</application> will try and
make sure that if you are using ssh-agent, it is actually managing some <application>SSH</application>
identities. This is to try and prevent <application>SSH</application> from asking for your pass phrase
for every module. You can disable this check by setting
<option>disable-agent-check</option> to <userinput>true</userinput>.
</entry>
</row>

<row xml:id="conf-do-not-compile">
<entry>do-not-compile</entry>
<entry>Module setting overrides global</entry>
<entry><para>Use this option to select a specific set of directories not to be built in a
module (instead of all of them). The directories not to build should be space-separated.</para>

<para>Note that the sources to the programs will still be downloaded. You can use
the <link linkend="conf-checkout-only">checkout-only</link>
directive to choose directories that you want to check out.</para>

<para>For example, to hold <application>JuK</application> and <application>KsCD</application> in the kdemultimedia module from
compiling, you would add "do-not-compile juk kscd" to your kdemultimedia
settings.</para>

<para>See <xref linkend="not-compiling"/> for an example.</para>
</entry>
</row>

<row xml:id="conf-email-address">
<entry>email-address</entry>
<entry>Cannot be overridden</entry>
<entry>
<para>This option was removed in <application>kdesrc-build</application> 1.14.
</para>
</entry>
</row>

<row xml:id="conf-email-on-compile-error">
<entry>email-on-compile-error</entry>
<entry>Cannot be overridden</entry>
<entry>
<para>This option was removed in <application>kdesrc-build</application> 1.14.
</para>
</entry>
</row>

<row>
<entry>inst-apps</entry>
<entry/>
<entry>
This option was removed in version 1.10
</entry>
</row>

<row xml:id="conf-git-desired-protocol">
<entry>git-desired-protocol</entry>
<entry>Cannot be overridden</entry>
<entry><para>This option only applies to modules from a <link linkend="kde-projects-module-sets"><orgname class="nonprofit">KDE</orgname> project</link> repository.</para>

<para>What this option actually does is configure which network protocol to
prefer when pushing source code for these modules. Normally the very-efficient
<literal>git</literal> protocol is used, but this may be blocked in some
networks (e.g. corporate intranets, public Wi-Fi). An alternative protocol
which is much better supported is the <literal>https</literal> protocol used for
Internet web sites.</para>

<para>If you are using one of these constrained networks you can set this
option to <userinput>http</userinput> to prefer <literal>https</literal>
communications instead.</para>

<tip><para>You may also need the <link linkend="conf-http-proxy">http-proxy</link> option if an HTTP proxy is also
needed for network traffic.</para></tip>

<para>In any other situation you should not set this option as the default
protocol is most efficient.</para>

<para>This option was added in <application>kdesrc-build</application> 1.16. Prior to 20.06 this option
was used to configure the fetch URL instead of the push URL. As of 20.06
<literal>https</literal> is always used when updating KDE projects.</para>
</entry>
</row>

<row xml:id="conf-git-repository-base">
<entry>git-repository-base</entry>
<entry>Cannot be overridden</entry>
<entry><para>This option, added in version 1.12.1, is used to create a short
name to reference a specific Git repository base URL in later <link linkend="module-sets">module set</link> declarations, which is useful for
quickly declaring many Git modules to build.</para>

<para>You must specify two things (separated by a space): The name to assign
to the base URL, and the actual base URL itself. For example:</para>

<para>
<informalexample>
<programlisting>
global
   # other options

   # This is the common path to all anonymous Git server modules.
   git-repository-base <replaceable>kde-git</replaceable> <replaceable>kde:</replaceable>
end global

# Module declarations

module-set
   # Now you can use the alias you defined earlier, but <emphasis>only</emphasis>
   # in a module-set.
   repository <replaceable>kde-git</replaceable>

   <link linkend="conf-use-modules">use-modules</link> <replaceable>module1.git</replaceable> <replaceable>module2.git</replaceable>
end module-set
</programlisting>
</informalexample>
</para>

<para>The module-set's <literal>use-modules</literal> option created two modules
internally, with <application>kdesrc-build</application> behaving as if it had read:</para>

<programlisting>
module module1
    repository kde:<replaceable>module1.git</replaceable>
end module

module module2
    repository kde:<replaceable>module2.git</replaceable>
end module
</programlisting>

<para>The <literal>kde:</literal> <application>Git</application> repository prefix used above is a
shortcut which will be setup by <application>kdesrc-build</application> automatically. See the TechBase
<link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://techbase.kde.org/Development/Git/Configuration#URL_Renaming">URL
Renaming</link> article for more information. Note that unlike most other
options, this option can be specified multiple times in order to create as
many aliases as necessary.</para>

<tip><para>It is not required to use this option to take advantage of module-set,
this option exists to make it easy to use the same repository across many
different module sets.</para></tip>
</entry>
</row>

<row xml:id="conf-git-user">
<entry>git-user</entry>
<entry>Module setting overrides global</entry>
<entry>
<para>This option is intended for <orgname class="nonprofit">KDE</orgname> developers. If set, it will be used to
automatically setup identity information for the <application>Git</application> source control software
for <emphasis>newly downloaded</emphasis> <application>Git</application> modules (including the vast
majority of <orgname class="nonprofit">KDE</orgname> modules).</para>

<para>Specifically, the user's name and email fields for each new <application>Git</application> repository are filled
in to the values set by this option.</para>

<para>The value must be specified in the form <option><replaceable>User
Name</replaceable> &lt;<replaceable>email@example.com</replaceable>&gt;</option>.</para>

<para>
<informalexample>
<para>For instance, a developer named <quote>Foo Barbaz</quote> with the
email address <quote>foo@abc.xyz</quote> would use:</para>

<screen>
    <symbol>git-user</symbol> <replaceable>Foo Barbaz</replaceable> &lt;<replaceable>foo@abc.xyz</replaceable>&gt;
</screen>
</informalexample>
</para>

<para>This option was introduced in <application>kdesrc-build</application> 15.09.
</para>
</entry>
</row>

<row xml:id="conf-http-proxy">
<entry>http-proxy</entry>
<entry>Module setting overrides global</entry>

<entry><para>This option, if set, uses the specified URL as a proxy server to use for
any HTTP network communications (for example, when downloading snapshots for
new modules, or the <link linkend="kde-projects-module-sets">KDE project
database</link>).</para>

<para>In addition, <application>kdesrc-build</application> will try to ensure that the tools it depends
on also use that proxy server, if possible, by setting the
<envar>http_proxy</envar> environment variable to the indicated server,
<emphasis>if that environment variable is not already set</emphasis>.</para>

<para>This option was introduced with <application>kdesrc-build</application> 1.16.</para>
</entry>
</row>

<row xml:id="conf-ignore-kde-structure">
<entry>ignore-kde-structure</entry>
<entry>Module setting overrides global</entry>
<entry>
<para>This option is deprecated and will be removed (again) in a future release.</para>

<para>Please use <option><link linkend="conf-directory-layout">directory-layout</link></option>
instead, which offers more options.</para>
</entry>
</row>

<row xml:id="conf-directory-layout">
<entry>directory-layout</entry>
<entry>Module setting overrides global</entry>
<entry><para>This option is used to configure the layout which <application>kdesrc-build</application> should use when
creating source and build directories.</para>
<para>Currently, there are three possible values: <userinput>metadata</userinput>,
<userinput>invent</userinput> and <userinput>flat</userinput></para>
<para>The <userinput>flat</userinput> layout will group all modules directly underneath the top level
source and build directories. For example,
<literal>source/extragear/network/telepathy/ktp-text-ui</literal> in the <userinput>metadata</userinput>
layout would be <literal>source/ktp-text-ui</literal> using the <userinput>flat</userinput> layout
instead.
</para>
<para>The <userinput>invent</userinput> layout creates a directory hierarchy mirroring the relative
paths of repositories on <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://invent.kde.org/">invent.kde.org</link>. For example
<literal>source/kde/applications/kate</literal> in the <userinput>metadata</userinput> layout would
be <literal>source/utilities/kate</literal> using the <userinput>invent</userinput> layout instead.
This layout only affects KDE projects. It is a good choice for people starting out with
<application>kdesrc-build</application>.
</para>
<para>Finally, the <userinput>metadata</userinput> layout is the same as the old default
behaviour. This layout organises KDE projects according to the project paths specified in the
project metadata for these modules. This is a good choice if you want a directory layout which
tracks with certain KDE processes, but note that this path is therefore not always stable. As a
result, <application>kdesrc-build</application> may abandon an old copy of the repository and clone a new one for a project
due to changes in the project metadata.</para>
<para>By default the <userinput>metadata</userinput> layout will be used, to preserve backwards
compatibility for existing users of <application>kdesrc-build</application>.</para>
</entry>
</row>

<row xml:id="conf-ignore-modules">
<entry>ignore-modules</entry>
<entry>Can't be overridden</entry>
<entry><para>Modules named by this option, which would be chosen by <application>kdesrc-build</application>
due to a <link linkend="conf-use-modules">use-modules</link> option, are
instead skipped entirely. Use this option when you want to build an entire
<link linkend="kde-projects-module-sets">kde-projects</link> project grouping
<emphasis>except for</emphasis> some specific modules.</para>

<para>The option value does not necessarily have to name the module directly.
Any module that has full consecutive parts of its <link linkend="kde-projects-module-sets"><orgname class="nonprofit">KDE</orgname> projects module path</link> match one
of the option values will be ignored, so you can ignore multiple modules this
way.</para>

<para>For example, an option value of <replaceable>libs</replaceable> would
result in both <symbol>kde/kdegraphics/libs</symbol> and
<symbol>playground/libs</symbol> being excluded (though not
<symbol>kde/kdelibs</symbol> since the full part <quote>kdelibs</quote> is what
is compared).</para>

<tip><para>See also <xref linkend="example-ignoring-a-module"/>.</para></tip>

<para>This option was introduced with <application>kdesrc-build</application> 1.16.</para>
</entry>
</row>

<row xml:id="conf-include-dependencies">
<entry>include-dependencies</entry>
<entry>Module setting overrides global</entry>
<entry>
<para>This option, when set to <userinput>true</userinput> requests that
<application>kdesrc-build</application> also include known dependencies of this module in its build,
without requiring you to mention those dependencies (even indirectly).</para>

<note><para>This option only works for <link linkend="kde-projects-module-sets"><literal>kde-project</literal>-based
modules</link>, and requires that the metadata maintained by the <orgname class="nonprofit">KDE</orgname>
developers is accurate for your selected <link linkend="conf-branch-group">branch-group</link>.</para></note>

<para>This option is enabled by default, to support building applications
that need versions of <trademark class="trade">Qt</trademark> or <productname>Plasma</productname> more recent than supported on
common operating systems.</para>
</entry>
</row>

<row xml:id="conf-install-after-build">
<entry>install-after-build</entry>
<entry>Module setting overrides global</entry>
<entry>This option is used to install the package after it successfully builds.
This option is enabled by default. If you want to disable this, you need to set
this option to <userinput>false</userinput> in the <link linkend="configure-data">configuration file</link>. You can also use the <link linkend="cmdline-no-install"><option>--no-install</option></link> command line
flag.
</entry>
</row>

<row xml:id="conf-install-environment-driver">
<entry>install-environment-driver</entry>
<entry>Cannot be overridden</entry>
<entry><para>By default, <application>kdesrc-build</application> will install a shell script that can be
sourced in a user's profile setup scripts to easily establish needed environment
variables to run the Plasma desktop built by <application>kdesrc-build</application>.</para>

<para>This driver will alter the following files:</para>

<itemizedlist>
<listitem><para><filename>$XDG_CONFIG_HOME/kde-env-master.sh</filename> (normally found at <filename>~/.config/kde-env-master.sh</filename>).</para></listitem>
<listitem><para><filename>$XDG_CONFIG_HOME/kde-env-user.sh</filename> (normally found at <filename>~/.config/kde-env-user.sh</filename>).</para></listitem>
</itemizedlist>

<para>The <filename>kde-env-user.sh</filename> is optional.  It is
intended for user customizations (see the <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://userbase.kde.org/KDE_System_Administration/Environment_Variables#Troubleshooting_and_Debugging">Troubleshooting and Debugging</link>
section of the <orgname class="nonprofit">KDE</orgname> UserBase for examples of customizable settings), but these settings
can be set elsewhere by the user in their existing profile setup scripts.</para>

<para>You can disable this feature by setting this option to
<replaceable>false</replaceable>, and ensuring that the <link linkend="conf-install-session-driver">install-session-driver</link> option is
also disabled.</para>

<para>This option was introduced with <application>kdesrc-build</application> 17.08.</para>

<tip><para><application>kdesrc-build</application> will not overwrite your existing files (if present)
unless you also pass the <option><link linkend="cmdline-delete-my-settings">--delete-my-settings</link></option>
command-line option.</para></tip>
</entry>
</row>

<row xml:id="conf-install-session-driver">
<entry>install-session-driver</entry>
<entry>Cannot be overridden</entry>
<entry><para>If enabled, <application>kdesrc-build</application> will try to install a driver for the graphical
login manager that allows you to login to your <application>kdesrc-build</application>-built <orgname class="nonprofit">KDE</orgname> desktop.</para>

<para>This driver will alter the following files:</para>

<itemizedlist>
<listitem><para><filename>~/.xsession</filename></para></listitem>
<listitem><para><filename>$XDG_CONFIG_HOME/kde-env-master.sh</filename> (normally found at <filename>~/.config/kde-env-master.sh</filename>).</para></listitem>
<listitem><para><filename>$XDG_CONFIG_HOME/kde-env-user.sh</filename> (normally found at <filename>~/.config/kde-env-user.sh</filename>).</para></listitem>
</itemizedlist>

<para>If you maintain your own login driver then you can disable this feature by setting this
option to <replaceable>false</replaceable>.  If enabled, this feature also enables the
<link linkend="conf-install-environment-driver">install-environment-driver</link> feature.</para>

<para>This option was introduced with <application>kdesrc-build</application> 1.16.</para>

<tip><para><application>kdesrc-build</application> will not overwrite your existing files (if present)
unless you also pass the <option><link linkend="cmdline-delete-my-settings">--delete-my-settings</link></option>
command-line option.</para></tip>
</entry>
</row>

<row xml:id="conf-kdedir">
<entry>kdedir</entry>
<entry>Module setting overrides global</entry>
<entry>This option sets the directory that <orgname class="nonprofit">KDE</orgname> will be installed to after it
is built. It defaults to <filename class="directory">~/kde</filename>. If you
change this to a directory needing root access, you may want to read about the
<link linkend="conf-make-install-prefix">make-install-prefix</link> option as
well.</entry>
</row>

<row xml:id="conf-kde-languages">
<entry>kde-languages</entry>
<entry>Cannot be overridden</entry>
<entry><para>This option allows you to choose to download and install
localization packages along with <orgname class="nonprofit">KDE</orgname>. You might do this if you do not live in
the United States and would like to use <orgname class="nonprofit">KDE</orgname> translated into your native
language.</para>

<para>To use this option, set it to a space-separated list of languages to
install. Each language has a language code associated with it, which you
can look up at this page: <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://l10n.kde.org/teams-list.php">http://l10n.kde.org/teams-list.php</link>.
</para>

<para>It is alright to choose only one language. By default, none are
downloaded, which means <orgname class="nonprofit">KDE</orgname> will display in American English.</para>

<para>For instance, to choose to install French, you would set the option to
something like: <userinput><option>kde-languages</option>
<replaceable>fr</replaceable></userinput>.  You would still need to use
<application>System Settings</application> in order to choose the French language, however.</para>
</entry>
</row>

<row xml:id="conf-libpath">
<entry>libpath</entry>
<entry>Module setting overrides global</entry>
<entry>Set this option to set the environment variable
<envar>LD_LIBRARY_PATH</envar> while building. You cannot override this setting
in a module option. The default value is blank, but the paths <filename class="directory">$<envar>KDEDIR</envar>/lib</filename> and <filename class="directory">$<envar>QTDIR</envar>/lib</filename> are automatically added.
You may use the tilde (~) for any paths you add using this option.
</entry>
</row>

<row xml:id="conf-log-dir">
<entry>log-dir</entry>
<entry>Module setting overrides global</entry>
<entry>Use this option to change the directory used to hold the log files
generated by the script.
</entry>
</row>

<row xml:id="conf-make-install-prefix">
<entry>make-install-prefix</entry>
<entry>Module setting overrides global</entry>
<entry>Set this variable to a space-separated list, which is interpreted as a
command and its options to precede the <userinput><command>make</command> <option>install</option></userinput> command used to install
modules. This is useful for installing packages with <application>Sudo</application> for example, but
please be careful while dealing with root privileges.</entry>
</row>

<row xml:id="conf-make-options">
<entry>make-options</entry>
<entry>Module setting overrides global (build system option)</entry>
<entry><para>Set this variable in order to pass command line options to the
<command>make</command> command. This is useful for programs such as <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/distcc/distcc"><application>distcc</application></link> or
systems with more than one processor core.</para>
<para>Note that not all supported build systems use <command>make</command>. For
build systems that use <command>ninja</command> for build (such as the
<link linkend="conf-override-build-system"><application>Meson</application>
build system</link>), see the <link linkend="conf-ninja-options">ninja-options</link>
setting.</para>
</entry>
</row>

<row xml:id="conf-manual-build">
<entry>manual-build</entry>
<entry>Module setting overrides global</entry>
<entry>Set the option value to <userinput>true</userinput> to keep the
build process from attempting to build this module. It will still be kept
up-to-date when updating from <application>Subversion</application>.  This option is exactly equivalent
to the <link linkend="cmdline-no-build"><option>--no-build</option></link>
command line option.
</entry>
</row>

<row xml:id="conf-manual-update">
<entry>manual-update</entry>
<entry>Module setting overrides global</entry>
<entry>Set the option value to <userinput>true</userinput> to keep the
build process from attempting to update (and by extension, build or install)
this module. If you set this option for a module, then you have essentially
commented it out.
</entry>
</row>

<row xml:id="conf-module-base-path">
<entry>module-base-path</entry>
<entry>Module setting overrides global</entry>
<entry><para>Set this option to override <application>kdesrc-build</application>'s default directory path to the
module in question. This can be used, for example, to pull specific branches
or tagged versions of libraries. <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://websvn.kde.org/">The <orgname class="nonprofit">KDE</orgname>
Source Viewer</link> is invaluable in helping to pick the right path.</para>

<para>Note that <application>kdesrc-build</application> constructs the final path according to the
following template:
<filename class="directory"><varname>$svn-server</varname>/home/kde/<varname>$module-base-path</varname></filename>.
</para>

<para>The default value is either <filename class="directory">trunk/<varname>$module</varname></filename> or <filename class="directory">trunk/KDE/<varname>$module</varname></filename>, depending on
the module name.</para>

<tip><para>Use the <link linkend="conf-branch">branch</link> or <link linkend="conf-tag">tag</link> options instead whenever they are applicable.
</para></tip>
</entry>
</row>

<row xml:id="conf-niceness">
<entry>niceness</entry>
<entry>Cannot be overridden</entry>
<entry>Set this option to a number between 20 and 0. The higher the number, the
lower a priority <application>kdesrc-build</application> will set for itself, i.e. the higher the
number, the "nicer" the program is. The default is 10.
</entry>
</row>

<row xml:id="conf-ninja-options">
<entry>ninja-options</entry>
<entry>Module setting overrides global (build system option)</entry>
<entry><para>Set this variable in order to pass command line options to the

<command>ninja</command> build command. This can be useful to enable <quote>verbose</quote> output
or to manually reduce the number of parallel build jobs that <command>ninja</command> would
use.</para>

<note><para>Note that this setting only controls ninja when used by <application>kdesrc-build</application>.
The <trademark class="trade">Qt</trademark> <quote>webengine</quote> module uses <command>ninja</command> indirectly, but
only officially supports being built by <command>make</command>.
In this situation, you can set <literal>NINJAFLAGS</literal> as a way to have
<command>make</command> pass the appropriate flags when it later calls
<command>ninja</command>, by using
<link linkend="conf-make-options">make-options</link>.</para>

<informalexample>
<programlisting>
options <replaceable>qtwebengine</replaceable>
    # Restrict make and ninja to using no more than 6 separate compile jobs even
    # when more CPU is available, to avoid running out of memory
    <option><link linkend="conf-make-options">make-options</link></option> -j<replaceable>6</replaceable> NINJAFLAGS=-j<replaceable>6</replaceable>
end options
</programlisting>
</informalexample>
</note>
</entry>
</row>

<row xml:id="conf-no-svn">
<entry>no-svn</entry>
<entry>Module setting overrides global</entry>
<entry>If this option is set to true then <application>kdesrc-build</application> will not update the
source code for the module automatically.  It will still try to build the
module if it normally would have tried anyways.</entry>
</row>

<row>
<entry>no-rebuild-on-fail</entry>
<entry/>
<entry>This option was removed in version 1.10, since this behavior no longer helps
due to fixes in the underlying build system.</entry>
</row>

<row xml:id="conf-num-cores">
<entry>num-cores</entry>
<entry>Cannot be overridden</entry>
<entry>
<para>This option is defined by <application>kdesrc-build</application> (when using the kdesrc-build-setup tool
or <command>kdesrc-build --initial-setup</command>), set to be the number of
available CPUs (as indicated by the external application
<application>nproc</application>). If <application>kdesrc-build</application> cannot detect the
number of CPUs, this value is set to 4.</para>

<para>See <xref linkend="make-options-example"/> for an example of this
option's usage. This option was added in version 20.07.</para>
</entry>
</row>

<row xml:id="conf-num-cores-low-mem">
<entry>num-cores-low-mem</entry>
<entry>Cannot be overridden</entry>
<entry>
<para>This option is defined by <application>kdesrc-build</application> (when using the kdesrc-build-setup tool
or <command>kdesrc-build --initial-setup</command>), set to be the number of
CPUs that is deemed safe for heavyweight or other highly-intensive modules,
such as <literal>qtwebengine</literal>, to avoid running out of memory
during the build.</para>

<para>The typical calculation is one CPU core for every 2
gigabytes (GiB) of total memory. At least 1 core will be specified,
and no more than <option><link linkend="conf-num-cores">num-cores</link></option>
cores will be specified.</para>

<para>Although this option is intended to support <trademark class="trade">Qt</trademark> modules, you can use it for your
any module in the same way that <option>num-cores</option> is used.</para>

<para>If <application>kdesrc-build</application> cannot detect available memory then this value will be
set to 2.</para>

<para>This option was added in version 20.07.</para>
</entry>
</row>

<row xml:id="conf-override-build-system">
<entry>override-build-system</entry>
<entry>Module setting overrides global</entry>
<entry><para>This is an advanced option, added in <application>kdesrc-build</application> 1.16.</para>

<para>Normally <application>kdesrc-build</application> will detect the appropriate build system to use
for a module after it is downloaded. This is done by checking for the existence
of specific files in the module's source directory.</para>

<para>Some modules may include more than one required set of files, which could confuse
the auto-detection. In this case you can manually specify the correct build type.</para>

<para>Currently supported build types that can be set are:</para>

<variablelist>
    <varlistentry>
        <term>KDE</term>
        <listitem><para>Used to build <orgname class="nonprofit">KDE</orgname> modules. In reality it can be used to build
            almost any module that uses <application>CMake</application> but it is best not to rely on this.</para></listitem>
    </varlistentry>
    <varlistentry>
        <term>Qt</term>
        <listitem><para>Used to build the <trademark class="trade">Qt</trademark> library itself.</para></listitem>
    </varlistentry>
    <varlistentry>
        <term>qmake</term>
        <listitem><para>Used to build <trademark class="trade">Qt</trademark> modules that use
            <application>qmake</application>-style <literal>.pro</literal>
            files.</para></listitem>
    </varlistentry>
    <varlistentry>
        <term>generic</term>
        <listitem><para>Used to build modules that use plain Makefiles and that do not
            require any special configuration.</para></listitem>
    </varlistentry>
    <varlistentry>
        <term>autotools</term>
        <listitem><para>This is the standard configuration tool used for most Free and
            open-source software not in any of the other categories.</para></listitem>
    </varlistentry>
    <varlistentry>
        <term>meson</term>
        <listitem><para>This is a <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://mesonbuild.com">relatively new
            tool</link> gaining popularity as a replacement for the autotools and may
            be required for some non-<orgname class="nonprofit">KDE</orgname> modules.</para></listitem>
    </varlistentry>
</variablelist>

</entry>
</row>

<row xml:id="conf-override-url">
<entry>override-url</entry>
<entry>Module setting overrides global</entry>
<entry>If you set this option, <application>kdesrc-build</application> will use its value as the <acronym>URL</acronym>
to pass to <application>Subversion</application> <emphasis>completely unchanged</emphasis>. You should
generally use this if you want to download a specific release but <application>kdesrc-build</application>
cannot figure out what you mean using <link linkend="conf-branch">branch</link>.
</entry>
</row>

<row xml:id="conf-persistent-data-file">
<entry>persistent-data-file</entry>
<entry>Cannot be overridden</entry>
<entry><para>Use this option to change where <application>kdesrc-build</application> stores its persistent
data. The default is to store this data in a file called
<filename>.kdesrc-build-data</filename> placed in the same directory as the
configuration file in use. If you have multiple available configurations in the
same directory you may want to manually set this option so that the different
configurations do not end up with conflicting persistent data.</para>

<para>This option was added with <application>kdesrc-build</application> 1.15.</para>
</entry>
</row>

<row xml:id="conf-prefix">
<entry>prefix</entry>
<entry>Module setting overrides global</entry>
<entry><para>This option controls where to install the module (normally the
<option><link linkend="conf-kdedir">kdedir</link></option> setting is used).
Using this option allows you to install a module to a different directory than
where the KDE Platform libraries are installed, such as if you were using
<application>kdesrc-build</application> only to build applications.</para>
<para>You can use <varname>${MODULE}</varname> or <varname>$MODULE</varname>
in the path to have them expanded to the module's name.</para>
</entry>
</row>

<row xml:id="conf-purge-old-logs">
<entry>purge-old-logs</entry>
<entry>Module setting overrides global</entry>
<entry><para>This option controls whether old log directories are automatically
deleted or not. The default value is <replaceable>true</replaceable>.</para>
</entry>
</row>

<row xml:id="conf-qmake-options">
<entry>qmake-options</entry>
<entry>Module setting overrides global</entry>

<entry><para>Any options specified here are passed to the
<command>qmake</command> command, for modules that use the
<symbol>qmake</symbol> build system. For instance, you can use the
<userinput>PREFIX=/path/to/qt</userinput> option to qmake to override where it
installs the module.
</para>
<para>This option was added to <application>kdesrc-build</application> 1.16.</para>
</entry>
</row>

<row xml:id="conf-qtdir">
<entry>qtdir</entry>
<entry>Module setting overrides global</entry>
<entry>Set this option to set the environment variable <envar>QTDIR</envar> while building.
If you do not specify this option, <application>kdesrc-build</application> will assume that <trademark class="trade">Qt</trademark> is
provided by the operating system.
</entry>
</row>

<row xml:id="conf-remove-after-install">
<entry>remove-after-install</entry>
<entry>Module setting overrides global</entry>
<entry><para>If you are low on hard disk space, you may want to use this option
in order to automatically delete the build directory (or both the source and
build directories for one-time installs) after the module is successfully
installed.
</para>
<para>Possible values for this option are:
<itemizedlist>
<listitem><para>none - Do not delete anything (This is the default).</para></listitem>
<listitem><para>builddir - Delete the build directory, but not the source.</para></listitem>
<listitem><para>all - Delete both the source code and build directory.</para></listitem>
</itemizedlist>
</para>

<para>Note that using this option can have a significant detrimental impact on
both your bandwidth usage (if you use <replaceable>all</replaceable>) and the time taken to compile <orgname class="nonprofit">KDE</orgname> software,
since <application>kdesrc-build</application> will be unable to perform incremental builds.</para>
</entry>
</row>

<row xml:id="conf-repository">
<entry>repository</entry>
<entry>Module setting overrides global</entry>
<entry><para>This option was introduced with version 1.10, and is used to
specify the <application>Git</application> repository to download the source code for the module.
<trademark class="trade">Qt</trademark> (and therefore qt) would need this option, as well as various
<orgname class="nonprofit">KDE</orgname> modules that are in the process of conversion to use <application>Git</application>.</para></entry>
</row>

<row xml:id="conf-revision">
<entry>revision</entry>
<entry>Module setting overrides global</entry>
<entry><para>If this option is set to a value other than 0 (zero), <application>kdesrc-build</application>
will force the source update to bring the module to the exact revision
given, even if options like <link linkend="conf-branch">branch</link> are in
effect. If the module is already at the given revision then it will not be
updated further unless this option is changed or removed from the
configuration.</para>

<note><para>This option did not work for git-based modules (including <link linkend="kde-projects-module-sets">kde-projects</link> modules) until
<application>kdesrc-build</application> version 1.16.</para></note>

</entry>
</row>

<row xml:id="conf-run-tests">
<entry>run-tests</entry>
<entry>Module setting overrides global (build system option)</entry>
<entry>If set to <userinput>true</userinput>, then the module will be
built with support for running its test suite, and the test suite will be
executed as part of the build process. <application>kdesrc-build</application> will show a simple
report of the test results. This is useful for developers or those who want
to ensure their system is setup correctly.</entry>
</row>

<row xml:id="conf-set-env">
<entry>set-env</entry>
<entry>Module setting overrides global</entry>
<entry><para>This option accepts a space-separated set of values, where the first value
is the environment variable to set, and the rest of the values is what you
want the variable set to. For example, to set the variable <envar>RONALD</envar> to
McDonald, you would put in the appropriate section this command:</para>
<screen><command>set-env</command> <envar>RONALD</envar> <userinput>McDonald</userinput></screen>
<para>This option is special in that it can be repeated without overriding
earlier set-env settings in the same section of the <link linkend="configure-data">configuration file</link>. This
way you can set more than one environment variable per module (or
globally).</para>
</entry>
</row>

<row xml:id="conf-source-dir">
<entry>source-dir</entry>
<entry>Module setting overrides global</entry>
<entry>This option is used to set the directory on your computer to store the <orgname class="nonprofit">KDE</orgname>
<application>Subversion</application> sources at. If you do not specify this value, the default is
<filename class="directory">~/kdesrc</filename>. You may use the tilde (~)
to represent the home directory if using this option.
</entry>
</row>

<row xml:id="conf-ssh-identity-file">
<entry>ssh-identity-file</entry>
<entry>Cannot be overridden</entry>
<entry>
<para>Set this option to control which private SSH key file is passed to the
<command>ssh-add</command> command when <application>kdesrc-build</application> is downloading source
code from repositories that require authentication. See also: <xref linkend="ssh-agent-reminder"/>.</para>

<para>This option was added in version 1.14.2.</para>
</entry>
</row>

<row xml:id="conf-stop-on-failure">
<entry>stop-on-failure</entry>
<entry>Module setting overrides global</entry>
<entry>Set this option value to <userinput>true</userinput> to cause the script to stop execution
after an error occurs during the build or install process. This option is off
by default.
</entry>
</row>

<row xml:id="conf-svn-server">
<entry>svn-server</entry>
<entry>Module setting overrides global</entry>
<entry><para>This option is used to set the server used to check out from <application>Subversion</application>.
The default is the anonymous <application>Subversion</application> repository, <filename>svn://anonsvn.kde.org/</filename></para>
<note><para>If you are developing for KDE, use the <application>Subversion</application> repository that
was provided to you when you received your developer account, instead of the
anonymous repository.</para></note>
</entry>
</row>

<row xml:id="conf-tag">
<entry>tag</entry>
<entry>Module setting overrides global</entry>
<entry><para>Use this option to download a specific release of a module.</para>
<para><emphasis>Note:</emphasis> The odds are very good that you <emphasis>do not
want</emphasis> to use this option. <orgname class="nonprofit">KDE</orgname> releases are available in tarball form
from the <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://download.kde.org/"><orgname class="nonprofit">KDE</orgname> download site</link>.</para>

<note><para>This option has only been supported for git-based modules since
<application>kdesrc-build</application> 1.16.</para></note>
</entry>
</row>

<row xml:id="conf-use-clean-install">
<entry>use-clean-install</entry>
<entry>Module setting overrides global (build system option)</entry>
<entry><para>Set this option to <userinput>true</userinput> in order to
have <application>kdesrc-build</application> run <command>make uninstall</command> directly before
running <command>make install</command>.</para>

<para>This can be useful in ensuring that there are not stray old library
files, <application>CMake</application> metadata, etc. that can cause issues in long-lived <orgname class="nonprofit">KDE</orgname>
installations. However this only works on build systems that support
<command>make uninstall</command>.</para>

<para>This option was added with <application>kdesrc-build</application> 1.12, but was not documented
until <application>kdesrc-build</application> 1.16.</para>
</entry>
</row>

<row>
<entry>use-cmake</entry>
<entry/>
<entry>This option was removed in <application>kdesrc-build</application> 1.4 as all <orgname class="nonprofit">KDE</orgname> 4 modules
require <application>CMake</application>, and <application>CMake</application> use is not permitted on any other modules.
</entry>
</row>

<row xml:id="conf-use-idle-io-priority">
<entry>use-idle-io-priority</entry>
<entry>Cannot be overridden</entry>
<entry>This option, added in <application>kdesrc-build</application> 1.12, will cause a lower priority
to be used for disk and other I/O usage, which can significantly improve the
responsiveness of the rest of the system at the expense of slightly longer
running times for <application>kdesrc-build</application>. The default is to be disabled, to enable
the lower disk priority set this to <userinput>true</userinput>.
</entry>
</row>

<row xml:id="conf-use-modules">
<entry>use-modules</entry>
<entry>Can only use in <link linkend="module-sets">module-set</link></entry>
<entry><para>This option, added in <application>kdesrc-build</application> 1.12.1, allows you to easily
specify many different modules to build at the same point in <link linkend="kdesrc-buildrc">the configuration file</link>.</para>

<para>This option <emphasis>must</emphasis> be used within a
<literal>module-set</literal>. Every identifier passed to this option is
internally converted to a <application>kdesrc-build</application> module, with a <link linkend="conf-repository"><option>repository</option></link> option set to the
module-set's repository combined with the identifier name in order to setup the
final repository to download from. All other options that are assigned in the
module-set are also copied to the generated modules unaltered.</para>

<para>The order that modules are defined in this option is important, because
that is also the order that <application>kdesrc-build</application> will process the generated modules
when updating, building, and installing. All modules defined in the given
module-set will be handled before <application>kdesrc-build</application> moves to the next module after
the module-set.</para>

<para>If you need to change the options for a generated module, simply declare
the module again after it is defined in the module-set, and set your options
as needed. Although you will change the options set for the module this way,
the module will still be updated and built in the order set by the module-set
(i.e. you can't reorder the build sequence doing this).</para>

<important><para>The name to use for the module if you do this is simply the
name that you passed to <option>use-modules</option>, with the exception that
any <literal>.git</literal> is removed.</para></important>

<para>See <xref linkend="module-sets"/> and <link linkend="conf-git-repository-base">git-repository-base</link> for a description
of its use and an example.</para>
</entry>
</row>

<row xml:id="conf-use-qt-builddir-hack">
<entry>use-qt-builddir-hack</entry>
<entry>Module setting overrides global</entry>
<entry>This option has been removed due to improvements in the <trademark class="trade">Qt</trademark> build
system.
</entry>
</row>

<row xml:id="conf-use-stable-kde">
<entry>use-stable-kde</entry>
<entry>Can't be overridden</entry>
<entry>
<para>This option is deprecated and will be removed (again) in a future release.</para>

<para>Please use the <option><link linkend="conf-branch-group">branch-group</link></option>
instead, which offers more selectivity.</para>
</entry>
</row>

</tbody>

</tgroup>
</table>

</section>
</chapter>

<chapter xml:id="cmdline">
<title>Command Line Options and Environment Variables</title>

<section xml:id="cmdline-usage">
<title>Command Line Usage</title>

<para><application>kdesrc-build</application> is designed to be run as follows:</para>

<cmdsynopsis sepchar=" ">
<command>kdesrc-build</command>
<arg rep="repeat" choice="opt"><replaceable>--options</replaceable></arg>
<arg rep="repeat" choice="opt"><replaceable>modules to build</replaceable></arg>
</cmdsynopsis>

<para>If no modules to build are specified on the command line, then
kdesrc-build will build all modules defined in its configuration file, in the
order listed in that file (although this can be modified by various
configuration file options).</para>

<section xml:id="cmdline-usage-options">
<title>Commonly used command line options</title>

<para>The full list of command line options is given in <xref linkend="supported-cmdline-params"/>. The most-commonly used options
include:</para>

<variablelist>
  <varlistentry>
    <term>--pretend (or -p)</term>
    <listitem><para>This option causes <application>kdesrc-build</application> to indicate what actions
    it would take, without actually really implementing them. This can be
    useful to make sure that the modules you think you are building will
    actually get built.</para></listitem>
  </varlistentry>

  <varlistentry>
    <term>--refresh-build</term>
    <listitem><para>This option forces <application>kdesrc-build</application> to build the given
    modules from an absolutely fresh start point. Any existing build directory
    for that module is removed and it is rebuilt. This option is useful if you
    have errors building a module, and sometimes is required when <trademark class="trade">Qt</trademark> or <orgname class="nonprofit">KDE</orgname>
    libraries change.</para></listitem>
  </varlistentry>

  <varlistentry>
    <term>--no-src</term>
    <listitem><para>This option skips the source update process. You might use
    it if you have very recently updated the source code (perhaps you did it
    manually or recently ran <application>kdesrc-build</application>) but still want to rebuild some
    modules.</para></listitem>
  </varlistentry>

  <varlistentry>
    <term>--no-build</term>
    <listitem><para>This option is similar to <option>--no-src</option> above,
    but this time the build process is skipped.</para></listitem>
  </varlistentry>
</variablelist>

</section>

<section xml:id="cmdline-usage-modules">
<title>Specifying modules to build</title>

<para>In general, specifying modules to build is as simple as passing their
module name as you defined it in the configuration file. You can also pass
modules that are part of a module set, either as named on <link linkend="conf-use-modules">use-modules</link>, or the name of the entire module
set itself, if you have given it a name.</para>

<para>In the specific case of module sets based against the <link linkend="kde-projects-module-sets">KDE project database</link>, <application>kdesrc-build</application>
will expand module name components to determine the exact module you
want. For example, <application>kdesrc-build</application>'s KDE project entry locates the project in
<literal>extragear/utils/kdesrc-build</literal>. You could specify any
of the following to build <application>kdesrc-build</application>:</para>

<informalexample>
<screen>
<prompt>%</prompt> <command>kdesrc-build</command> <option><replaceable>+extragear/utils/kdesrc-build</replaceable></option>
<prompt>%</prompt> <command>kdesrc-build</command> <option><replaceable>+utils/kdesrc-build</replaceable></option>
<prompt>%</prompt> <command>kdesrc-build</command> <option><replaceable>+kdesrc-build</replaceable></option>
</screen>
</informalexample>

<note><para>The commands in the previous example preceded the module-name with
a <symbol>+</symbol>. This forces the module name to be interpreted as a module
from the KDE project database, even if that module hasn't been defined in your
configuration file.
</para></note>

<para>Be careful about specifying very generic projects (e.g.
<literal>extragear/utils</literal> by itself), as this can lead to a large
amount of modules being built. You should use the <option>--pretend</option>
option before building a new module set to ensure it is only building the
modules you want.</para>

</section>
</section>

<section xml:id="supported-envvars">
<title>Supported Environment Variables</title>

<para>
<application>kdesrc-build</application> does not use environment variables. If you need to set environment
variables for the build or install process, please see the <link linkend="conf-set-env">set-env</link> option.
</para>

</section>

<section xml:id="supported-cmdline-params">
<title>Supported command-line parameters</title>

<para>
The script accepts the following command-line options:
</para>

<variablelist>

<varlistentry xml:id="cmdline-async">
<term>--async</term>
<listitem><para>
Enables the <link linkend="conf-async">asynchronous mode</link>, which can
perform the source code updates and module builds at the same time.  This is
the default, this option only needs specified if you have disabled it in the
configuration.
</para></listitem>
</varlistentry>

<varlistentry xml:id="cmdline-help">
<term>--help</term>
<listitem><para>
Only display simple help on this script.
</para></listitem>
</varlistentry>

<varlistentry xml:id="cmdline-version">
<term>--version (or -v)</term>
<listitem><para>
Display the program version.
</para></listitem>
</varlistentry>

<varlistentry xml:id="cmdline-show-info">
<term>--show-info</term>
<listitem><para>
Displays information about <application>kdesrc-build</application> and the operating system, that may
prove useful in bug reports or when asking for help in forums or mailing lists.
</para>
<para>Available since version 18.11.</para>
</listitem>
</varlistentry>

<varlistentry xml:id="cmdline-initial-setup">
<term>--initial-setup</term>
<listitem><para>
Has <application>kdesrc-build</application> perform the one-time initial setup necessary to prepare
the system for <application>kdesrc-build</application> to operate, and for the newly-installed <orgname class="nonprofit">KDE</orgname>
software to run.
</para>
<para>This includes:</para>
<itemizedlist>
<listitem><para>Installing known dependencies (on supported <trademark class="registered">Linux</trademark> distributions)</para></listitem>
<listitem><para>Adding required environment variables to <literal>~/.bashrc</literal></para></listitem>
<listitem><para>Setting up a <link linkend="setup-rcfile">configuration file</link></para></listitem>
</itemizedlist>

<para>Available since version 18.11.</para>
</listitem>
</varlistentry>

<varlistentry xml:id="cmdline-author">
<term>--author</term>
<listitem><para>
Display contact information for the
author.
</para></listitem>
</varlistentry>

<varlistentry xml:id="cmdline-color">
<term>--color</term>
<listitem><para>
Enable colorful output. (This is the default for interactive terminals).
</para></listitem>
</varlistentry>

<varlistentry xml:id="cmdline-nice">
<term>--nice=value</term>
<listitem><para>
This value adjusts the computer CPU priority requested by <application>kdesrc-build</application>, and
should be in the range of 0-20. 0 is highest priority (because it is the
least <quote>nice</quote>), 20 is lowest priority. <application>kdesrc-build</application> defaults
to 10.
</para></listitem>
</varlistentry>

<varlistentry xml:id="cmdline-no-async">
<term>--no-async</term>
<listitem><para>
Disables the <link linkend="conf-async">asynchronous mode</link> of updating.
Instead the update will be performed in its entirety before the build starts.
This option will slow down the overall process, but if you encounter IPC errors
while running <application>kdesrc-build</application> try using this option, and submitting a
<link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://bugs.kde.org/">bug report</link>.
</para></listitem>
</varlistentry>

<varlistentry xml:id="cmdline-no-color">
<term>--no-color</term>
<listitem><para>
Disable colorful output.
</para></listitem>
</varlistentry>

<varlistentry xml:id="cmdline-pretend">
<term>--pretend (or -p)</term>
<listitem><para>
<application>kdesrc-build</application> will run through the update and build process, but instead of
performing any actions to update or build, will instead output what the
script would have done (e.g. what commands to run, general steps being taken,
etc.).</para>

<note><para>Simple read-only commands (such as reading file information) may
still be run to make the output more relevant (such as correctly simulating
whether source code would be checked out or updated).
</para></note>

<important><para>This option requires that some needed metadata is available,
which is normally automatically downloaded, but downloads are disabled in
pretend mode. If you've never run <application>kdesrc-build</application> (and therefore, don't have
this metadata), you should run <command>kdesrc-build
<option>--metadata-only</option></command> to download the required metadata
first.
</para></important>
</listitem>
</varlistentry>

<varlistentry xml:id="cmdline-quiet">
<term>--quiet (or -q)</term>
<listitem><para>
Do not be as noisy with the output. With this switch only the basics are
output.
</para></listitem>
</varlistentry>

<varlistentry xml:id="cmdline-really-quiet">
<term>--really-quiet</term>
<listitem><para>
Only output warnings and errors.
</para></listitem>
</varlistentry>

<varlistentry xml:id="cmdline-verbose">
<term>--verbose</term>
<listitem><para>
Be very descriptive about what is going on, and what <application>kdesrc-build</application> is doing.
</para></listitem>
</varlistentry>

<varlistentry xml:id="cmdline-src-only">
<term>--src-only (or --svn-only)</term>
<listitem><para>
Only perform the source update. (The <parameter>--svn-only</parameter> is
only supported for compatibility with older scripts).
</para></listitem>
</varlistentry>

<varlistentry xml:id="cmdline-build-only">
<term>--build-only</term>
<listitem><para>
Only perform the build process.
</para></listitem>
</varlistentry>

<varlistentry xml:id="cmdline-install-only">
<term>--install-only</term>
<listitem><para>
Only perform the install process.
</para></listitem>
</varlistentry>

<varlistentry xml:id="cmdline-metadata-only">
<term>--metadata-only</term>
<listitem><para>
Only perform the metadata download process. <application>kdesrc-build</application> normally handles this
automatically, but you might manually use this to allow the <option><link linkend="cmdline-pretend">--pretend</link></option> command line option to work.
</para></listitem>
</varlistentry>

<varlistentry xml:id="cmdline-rebuild-failures">
<term>--rebuild-failures</term>
<listitem><para>
Use this option to build only those modules which failed to build on a previous
<application>kdesrc-build</application> run. This is useful if a significant number of failures occurred mixed with
successful builds. After fixing the issue causing the build failures you can then easily
build only the modules that failed previously.</para>

<note><para>Note that the list of <quote>previously-failed modules</quote> is
reset every time a <application>kdesrc-build</application> run finishes with some module failures.
However it is not reset by a completely successful build, so you can
successfully rebuild a module or two and this flag will still
work.</para></note>

<para>This option was added for <application>kdesrc-build</application> 15.09.</para>
</listitem>
</varlistentry>

<varlistentry xml:id="cmdline-include-dependencies">
<term>--include-dependencies</term>
<term>--no-include-dependencies</term>
<listitem><para>
This option causes <application>kdesrc-build</application> to automatically include other <orgname class="nonprofit">KDE</orgname> and <trademark class="trade">Qt</trademark>
modules in the build, if required for the modules you have requested to build
on the command line or in your
<link linkend="configure-data">configuration file</link>.</para>

<para>The modules that are added are as recorded within the <orgname class="nonprofit">KDE</orgname> source code
management system. See <xref linkend="kde-projects-module-sets"/>.</para>

<para>The corresponding configure file option is
<link linkend="conf-include-dependencies">include-dependencies</link>.</para>

<para>You can also use <parameter>--no-include-dependencies</parameter>, which turns off
automatic inclusion of additional dependency modules.</para>
</listitem>
</varlistentry>

<varlistentry xml:id="cmdline-ignore-modules">
<term>--ignore-modules</term>
<listitem><para>
Do not include the modules passed on the rest of the command line in the
update/build process (this is useful if you want to build most of the modules
in your <link linkend="configure-data">configuration file</link> and just skip
a few).
</para></listitem>
</varlistentry>

<varlistentry xml:id="cmdline-no-src">
<term>--no-src (or --no-svn)</term>
<listitem><para>
Skip contacting the <application>Subversion</application> server. (The <parameter>--no-svn</parameter>
parameter is only supported for compatibility with older versions of the
script).
</para></listitem>
</varlistentry>

<varlistentry xml:id="cmdline-no-build">
<term>--no-build</term>
<listitem><para>
Skip the build process.
</para></listitem>
</varlistentry>

<varlistentry xml:id="cmdline-no-metadata">
<term>--no-metadata</term>
<listitem><para>
Do not automatically download the extra metadata needed for <orgname class="nonprofit">KDE</orgname> git modules.
The source updates for the modules themselves will still occur unless you pass
<link linkend="cmdline-no-src">--no-src</link> as well.
</para><para>
This can be useful if you are frequently re-running <application>kdesrc-build</application> since the
metadata does not change very often. But note that many other features require
the metadata to be available. You might want to consider running <application>kdesrc-build</application>
with the <link linkend="cmdline-metadata-only">--metadata-only</link> option
one time and then using this option for subsequent runs.
</para></listitem>
</varlistentry>

<varlistentry xml:id="cmdline-no-install">
<term>--no-install</term>
<listitem><para>
Do not automatically install packages after they are built.
</para></listitem>
</varlistentry>

<varlistentry xml:id="cmdline-no-build-when-unchanged">
<term>--no-build-when-unchanged</term>
<term>--force-build</term>
<listitem><para>
This option explicitly disables skipping the build process (an optimization
controlled by the <link linkend="conf-build-when-unchanged">build-when-unchanged</link> option). This is
useful for making <application>kdesrc-build</application> run the build when you have changed something
that <application>kdesrc-build</application> cannot check.</para>

<para><parameter>--force-build</parameter> performs the exact same function, and
is perhaps easier to remember.</para>
</listitem>
</varlistentry>

<varlistentry xml:id="cmdline-debug">
<term>--debug</term>
<listitem><para>
Enables debug mode for the script. Currently this means that all output will be
dumped to the standard output in addition to being logged in the log directory
like normal. Also, many functions are much more verbose about what they are
doing in debugging mode.
</para></listitem>
</varlistentry>

<varlistentry xml:id="cmdline-query">
<term>--query=mode</term>
<listitem><para>
This command causes <application>kdesrc-build</application> to query a parameter of the modules in the
build list (either passed on the command line or read in from the configuration
file), outputting the result to screen (one module per line).</para>

<para>This option must be provided with a <quote>query mode</quote>, which should be
one of the following:</para>
    <itemizedlist>
    <listitem><para><option>source-dir</option>, which causes <application>kdesrc-build</application> to
        output the full path to where the module's source code is stored.
        </para></listitem>
    <listitem><para><option>build-dir</option>, which causes <application>kdesrc-build</application> to
        output the full path to where the module build process occurs.
        </para></listitem>
    <listitem><para><option>install-dir</option>, which causes <application>kdesrc-build</application> to
        output the full path to where the module will be installed.
        </para></listitem>
    <listitem><para><option>project-path</option>, which causes <application>kdesrc-build</application> to
        output the location of the module within the hierarchy of KDE source
        code repositories. See <xref linkend="kde-projects-module-sets"/> for
        more information on this hierarchy.
        </para></listitem>
    <listitem><para><option>branch</option>, which causes <application>kdesrc-build</application> to
        output the resolved git branch that will be used for each module, based
        on the <link linkend="conf-tag">tag</link>, <link linkend="conf-branch">branch</link> and <link linkend="conf-branch-group">branch-group</link> settings in effect.
        </para></listitem>
    <listitem><para>Otherwise, option names that are valid for modules in the
        <link linkend="conf-options-table">configuration file</link> can be
        used, the resolved value of which will be listed for each module.
        </para></listitem>
    </itemizedlist>

<para>
If a single module is passed on the command line, then the output is simply the
value of the parameter being queried. If multiple (or no) modules are passed on
the command line, then each line is prefixed by the name of the module. Either way,
<application>kdesrc-build</application> stops running once each value is output.
</para>

<para>This option was added with <application>kdesrc-build</application> 16.05.</para>

<informalexample>
<para>For example, the command <quote><command>kdesrc-build</command>
    <parameter>--query</parameter>
    <parameter><replaceable>branch</replaceable></parameter>
    <parameter><replaceable>kactivities</replaceable></parameter>
    <parameter><replaceable>kdepim</replaceable></parameter></quote>
might end up with output like:</para>
<screen>
kactivities: master
kdepim: master
</screen>
</informalexample>
</listitem>
</varlistentry>

<varlistentry xml:id="cmdline-no-rebuild-on-fail">
<term>--no-rebuild-on-fail</term>
<listitem><para>
Do not try to
rebuild modules that have failed building from scratch. <application>kdesrc-build</application> will
never try to do this to a module that already was tried to be built from
scratch.
</para></listitem>
</varlistentry>

<varlistentry xml:id="cmdline-refresh-build">
<term>--refresh-build</term>
<listitem><para>
Recreate the build system and make from scratch.
</para></listitem>
</varlistentry>

<varlistentry xml:id="cmdline-reconfigure">
<term>--reconfigure</term>
<listitem><para>
Run <command>cmake</command> (for <orgname class="nonprofit">KDE</orgname> modules) or
<command>configure</command> (for <trademark class="trade">Qt</trademark>) again, without cleaning the build
directory. You should not normally have to specify this, as <application>kdesrc-build</application> will
detect when you change the relevant options and automatically re-run the build
setup. This option is implied if <parameter><link linkend="cmdline-refresh-build">--refresh-build</link></parameter> is used.
</para></listitem>
</varlistentry>

<varlistentry xml:id="cmdline-resume-from">
<term>--resume-from</term>
<listitem><para>
This option is used to resume the build starting from the given module, which
should be the next option on the command line. You should not
specify other module names on the command line.
</para>

<note><para>This option formerly added <link linkend="cmdline-no-src"><parameter>--no-src</parameter></link>, but does
not any longer (since <application>kdesrc-build</application> 1.13). If you want to avoid source updates
when resuming, simply pass <option><userinput>--no-src</userinput></option>
in addition to the other options.
</para></note>

<para>See also: <xref linkend="cmdline-resume-after"/> and <xref linkend="resuming-failed"/>. You would prefer to use this command line option
if you have fixed the build error and want <application>kdesrc-build</application> to complete the
build.</para></listitem>
</varlistentry>

<varlistentry xml:id="cmdline-resume-after">
<term>--resume-after</term>
<listitem><para>
This option is used to resume the build starting after the given module, which
should be the next option on the command line. You should not
specify other module names on the command line.
</para>

<note><para>This option formerly added <link linkend="cmdline-no-src"><parameter>--no-src</parameter></link>, but does
not any longer (since <application>kdesrc-build</application> 1.13). If you want to avoid source updates
when resuming, simply pass <option><userinput>--no-src</userinput></option>
in addition to the other options.
</para></note>

<para>See also: <xref linkend="cmdline-resume-from"/> and <xref linkend="resuming-failed"/>. You would prefer to use this command line option
if you have fixed the build error and have also built and installed the module
yourself, and want <application>kdesrc-build</application> to start again with the next
module.</para></listitem>
</varlistentry>

<varlistentry xml:id="cmdline-resume">
<term>--resume</term>
<listitem><para>

This option can be used to run <application>kdesrc-build</application> after it has had a build failure.
</para><para>

It resumes the build from the module that failed, using the list of modules
that were waiting to be built before, and disables source and metadata updates
as well. The use case is when a simple mistake or missing dependency causes the
build failure. Once you correct the error you can quickly get back into
building the modules you were building before, without fiddling with
<option><link linkend="cmdline-resume-from">--resume-from</link></option> and
<option><link linkend="cmdline-stop-before">--stop-before</link></option>.

</para><para>
This is even handier with the <option><link linkend="cmdline-stop-on-failure">--stop-on-failure</link></option> command
line argument, especially if you're initially setting up your development
environment.

</para><para>
This option was added with <application>kdesrc-build</application> 1.16.

</para></listitem>
</varlistentry>

<varlistentry xml:id="cmdline-stop-before">
<term>--stop-before</term>
<listitem><para>
This command line option is used to stop the normal build process just
<emphasis>before</emphasis> a module would ordinarily be built.
</para><para>
For example, if the normal build list was <simplelist type="inline">
<member>moduleA</member><member>moduleB</member><member>moduleC</member></simplelist>,
then <option>--stop-before=<replaceable>moduleB</replaceable></option> would cause
<application>kdesrc-build</application> to only build <literal>moduleA</literal>.
</para><para>
This command line option was added with <application>kdesrc-build</application> 1.16.
</para></listitem>
</varlistentry>

<varlistentry xml:id="cmdline-stop-after">
<term>--stop-after</term>
<listitem><para>
This command line option is used to stop the normal build process just
<emphasis>after</emphasis> a module would ordinarily be built.
</para><para>
For example, if the normal build list was <simplelist type="inline">
<member>moduleA</member><member>moduleB</member><member>moduleC</member></simplelist>,
then <option>--stop-after=<replaceable>moduleB</replaceable></option> would cause
<application>kdesrc-build</application> to build <literal>moduleA</literal> and <literal>moduleB</literal>.
</para><para>
This command line option was added with <application>kdesrc-build</application> 1.16.
</para></listitem>
</varlistentry>

<varlistentry xml:id="cmdline-stop-on-failure">
<term>--stop-on-failure</term>
<listitem><para>
This option causes the build to abort as soon as a failure occurs. Useful when
you're setting up your initial development environment. Without this flag,
<application>kdesrc-build</application> will try to press on with the rest of the modules in the build
to avoid wasting time in case the problem is with a single module.
</para><para>
This option was added with <application>kdesrc-build</application> 1.16. See also the
<link linkend="conf-stop-on-failure">stop-on-failure</link> option.
</para></listitem>
</varlistentry>

<varlistentry xml:id="cmdline-rc-file">
<term>--rc-file</term>
<listitem><para>
This interprets the next command line parameter as the file to read the
configuration options from. The default value for this parameter is
<filename>kdesrc-buildrc</filename> (checked in the current directory) if
it is present, or <filename>~/.kdesrc-buildrc</filename> otherwise. See
also <xref linkend="kdesrc-buildrc"/>.
</para></listitem>
</varlistentry>

<varlistentry xml:id="cmdline-print-modules">
<term>--print-modules</term>
<listitem>
<para>
    Takes all actions up to and including dependency reordering of the modules
    specified on the command line (or configuration file), prints the modules
    that would be processed one per line, and then exits without further action.
</para>
<para>
    The <literal>kde-project</literal> metadata is downloaded first (though, see
    <link linkend="cmdline-pretend"><option>--pretend</option></link> or <link linkend="cmdline-no-src"><option>--no-src</option></link>).
</para>
<para>
    The output is not fully compatible with usage by scripts as other output messages
    may be generated until the module list is shown.
</para>
<para>
    This is mostly just useful for quickly determining what <application>kdesrc-build</application>
    understands a module's dependencies to be, which means it's only useful for
    <link linkend="kde-projects-module-sets"><literal>kde-projects</literal></link>
    modules.  This option is also compatible with <link linkend="cmdline-resume-from"><option>--resume-from</option></link>, <link linkend="cmdline-resume-after"><option>--resume-after</option></link>,
    <link linkend="cmdline-stop-before"><option>--stop-before</option></link>,
    <link linkend="cmdline-stop-after"><option>--stop-after</option></link>.
</para></listitem>
</varlistentry>

<varlistentry xml:id="cmdline-list-build">
<term>--list-build</term>
<listitem>
<para>
    Lists the modules that would be built, in the order in which they would be built.
    If applicable, the output listing also mentions which commit/branch/tag would be
    selected for checkout.
</para>
<para>
    This option is similar to
    <link linkend="cmdline-print-modules"><option>--print-modules</option></link>.
    For more detailed information on how modules relate to each other, see also:
    <link linkend="cmdline-dependency-tree"><option>--dependency-tree</option></link>.
</para>
</listitem>
</varlistentry>

<varlistentry xml:id="cmdline-dependency-tree">
<term>--dependency-tree</term>
<listitem>
<para>
    Prints out dependency information on the modules that would be built using a tree
    format (recursive). Listed information also includes which specific commit/branch/tag
    is depended on and whether or not the dependency would be built. Note: the generated
    output may become quite large for applications with many dependencies.
</para>
</listitem>
</varlistentry>

<varlistentry xml:id="cmdline-run">
<term>--run</term>
<listitem><para>
This option interprets the next item on the command line as a program to run,
and <application>kdesrc-build</application> will then finish reading the configuration file, update the
environment as normal, and then execute the given program.</para>

<para>This will not work to start a shell with the <application>kdesrc-build</application> environment
in most cases however, since interactive shells typically reset at least part
of the environment variables (such as <envar>PATH</envar> and
<envar>KDEDIRS</envar>) in the startup sequence.
</para>

<tip><para>If you want to see the environment used by <application>kdesrc-build</application>, you
can run the <command>printenv</command> command:</para>
<informalexample>
<screen>$ <command>kdesrc-build</command> <parameter>--run</parameter> <parameter>printenv</parameter>
KDE_SESSION_VERSION=4
SDL_AUDIODRIVER=alsa
LANGUAGE=
XCURSOR_THEME=Oxygen_Blue
LESS=-R -M --shift 5
QMAIL_CONTROLDIR=/var/qmail/control
... etc.
</screen>
</informalexample></tip>
</listitem>
</varlistentry>

<varlistentry xml:id="cmdline-prefix">
<term>--prefix=&lt;/path/to/kde&gt;</term>
<listitem><para>
This allows you to change the directory that <orgname class="nonprofit">KDE</orgname> will be installed to from
the command line.  This option implies <link linkend="cmdline-reconfigure"><parameter>--reconfigure</parameter></link>,
but using <link linkend="cmdline-refresh-build"><parameter>--refresh-build</parameter></link>
may still be required.
</para></listitem>
</varlistentry>

<varlistentry xml:id="cmdline-revision">
<term>--revision</term>
<listitem><para>
This option causes <application>kdesrc-build</application> to checkout a specific numbered revision
for each <application>Subversion</application> module, overriding any <link linkend="conf-branch">branch</link>,
<link linkend="conf-tag">tag</link>, or <link linkend="conf-revision">revision</link>
options already set for these modules.</para>

<para>This option is likely not a good idea, and is only supported for
compatibility with older scripts.
</para></listitem>
</varlistentry>

<varlistentry xml:id="cmdline-build-system-only">
<term>--build-system-only</term>
<listitem><para>
This option causes <application>kdesrc-build</application> to abort building a module just before
the <command>make</command> command would have been run. This is supported
for compatibility with older versions only, this effect is not helpful for
the current <orgname class="nonprofit">KDE</orgname> build system.
</para></listitem>
</varlistentry>

<varlistentry xml:id="cmdline-install"><term>--install</term>
<listitem><para>
If this is the only command-line option, it tries to install all of the modules
contained in <filename>log/latest/build-status</filename>. If command-line
options are specified after <parameter>--install</parameter>, they are all
assumed to be modules to install (even if they did not successfully build on
the last run).
</para></listitem>
</varlistentry>

<varlistentry xml:id="cmdline-no-snapshots"><term>--no-snapshots</term>
<listitem><para>
Supplying this option causes <application>kdesrc-build</application> to always perform a normal initial
checkout of a module instead of using a quick-start snapshot (only available
for Git modules from the <literal>kde-projects</literal> repository).

Note that this option should only be used if there is a failure using
snapshots, as the quick-start snapshot reduces load on the KDE source
repositories.
</para>

<note><para>Module snapshots <emphasis>are</emphasis> real checkouts. You
should not need to specify this option, it is only a troubleshooting
aid.</para></note>
</listitem>
</varlistentry>

<varlistentry xml:id="cmdline-delete-my-patches">
<term>--delete-my-patches</term>
<listitem><para>
This option is used to let <application>kdesrc-build</application> delete source directories that may
contain user data, so that the module can be re-downloaded. This would normally
only be useful for <orgname class="nonprofit">KDE</orgname> developers (who might have local changes that would be
deleted).</para>

<para>This is currently only used to checkout modules that have been converted
from <application>Subversion</application> to <application>Git</application>. You should not use this option normally,
<application>kdesrc-build</application> will prompt to be re-run with it if it is needed.</para>
</listitem>
</varlistentry>

<varlistentry xml:id="cmdline-delete-my-settings">
<term>--delete-my-settings</term>
<listitem><para>
This option is used to let <application>kdesrc-build</application> overwrite existing files which may contain
user data.</para>

<para>This is currently only used for xsession setup for the login manager. You
should not use this option normally, <application>kdesrc-build</application> will prompt to be re-run
with it if it is needed.</para>
</listitem>
</varlistentry>

<varlistentry xml:id="cmdline-global-option">
<term>--&lt;option-name&gt;=</term>
<listitem><para>
You can use this option to override an option in your <link linkend="configure-data">configuration file</link> for
every module. For instance, to override the <link linkend="conf-log-dir">log-dir</link> option, you would do:
<userinput><parameter>--log-dir=<filename class="directory"><replaceable>/path/to/dir</replaceable></filename></parameter></userinput>.
</para>

<note><para>This feature can only be used for option names already recognized
by <application>kdesrc-build</application>, that are not already supported by relevant command line
options.  For example the <link linkend="conf-async">async</link> configuration
file option has specific <link linkend="cmdline-async">--async</link> and <link linkend="cmdline-no-async">--no-async</link> command line options that are
preferred by <application>kdesrc-build</application>.
</para></note>

</listitem>
</varlistentry>

<varlistentry xml:id="cmdline-module-option">
<term>--set-module-option-value=&lt;module-name&gt;,&lt;option-name&gt;,&lt;option-value&gt;</term>
<listitem><para>
You can use this option to override an option in your <link linkend="configure-data">configuration file</link> for
a specific module.
</para></listitem>
</varlistentry>

</variablelist>

<para>
Any other command-line options are assumed to be modules to update and build.
Please, do not mix building with installing.
</para>

</section>

</chapter>

<chapter xml:id="using-kdesrc-build">
<title>Using <application>kdesrc-build</application></title>

<section xml:id="using-kdesrc-build-preface">
<title>Preface</title>

<para>Normally using <application>kdesrc-build</application> after you have gone through <xref linkend="getting-started"/>
is as easy as doing the following from a terminal prompt:</para>

<screen>
<prompt>%</prompt> <command><userinput>kdesrc-build</userinput></command>
</screen>

<para><application>kdesrc-build</application> will then download the sources for <orgname class="nonprofit">KDE</orgname>, try to configure
and build them, and then install them.</para>

<para>Read on to discover how <application>kdesrc-build</application> does this, and what else you can
do with this tool.</para>

</section>

<section xml:id="basic-features">
<title>Basic <application>kdesrc-build</application> features</title>

<section xml:id="using-qt">
<title>qt support</title>
<para><application>kdesrc-build</application> supports building the <trademark class="trade">Qt</trademark> toolkit used by <orgname class="nonprofit">KDE</orgname> software
as a convenience to users. This support is handled by a special module named
qt.</para>

<note><para><trademark class="trade">Qt</trademark> is developed under a separate repository from <orgname class="nonprofit">KDE</orgname> software
located at <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://code.qt.io/cgit/qt/">http://code.qt.io/cgit/qt/</link>.</para></note>

<para>In order to build <trademark class="trade">Qt</trademark>, you should make sure that the
<link linkend="conf-qtdir">qtdir</link> setting is set to the directory you'd
like to install <trademark class="trade">Qt</trademark> to, as described in <xref linkend="configure-data"/>.</para>

<para>You should then ensure that the qt module is added to
your <filename>.kdesrc-buildrc</filename>, before any other modules in the
file. If you are using the sample configuration file, you can simply
uncomment the existing qt module entry.</para>

<para>Now you should verify the <link linkend="conf-repository">repository</link> option and <link linkend="conf-branch">branch</link> options are set appropriately:</para>

<orderedlist>
<listitem><para>The first option is to build <trademark class="trade">Qt</trademark> using a mirror maintained
on the <orgname class="nonprofit">KDE</orgname> source repositories (no other changes are applied, it is simply
a clone of the official source). This is highly recommended due to occasional
issues with cloning the full <trademark class="trade">Qt</trademark> module from its official repository.</para>

<para>You can set the <option>repository</option> option for the qt
module to <userinput>kde:qt</userinput> to use this option.</para>
</listitem>

<listitem><para>Otherwise, to build the standard <trademark class="trade">Qt</trademark>, set your
<option>repository</option> option to
<userinput>git://gitorious.org/qt/qt.git</userinput>. Note that you may
experience problems performing the initial clone of <trademark class="trade">Qt</trademark> from this
repository.</para></listitem>
</orderedlist>

<para>In both cases, the branch option should be set to <userinput>master</userinput> (unless you'd
like to build a different branch).</para>

</section>

<section xml:id="kdesrc-build-std-flags">
<title>Standard flags added by <application>kdesrc-build</application></title>
<para>Nota Bene: this section does not apply to modules for which you have
configured a custom toolchain, using e.g.
<link linkend="conf-cmake-toolchain">cmake-toolchain</link>.</para>

<para>To save you time, <application>kdesrc-build</application> adds some standard paths to your
environment for you:
</para>

<itemizedlist>
<listitem><para>
The path to the <orgname class="nonprofit">KDE</orgname> and <trademark class="trade">Qt</trademark> libraries is added to the
<envar>LD_LIBRARY_PATH</envar> variable automatically. This means that you
do not need to edit <link linkend="conf-libpath">libpath</link> to include them.
</para></listitem>

<listitem><para>
The path to the <orgname class="nonprofit">KDE</orgname> and <trademark class="trade">Qt</trademark> development support programs are added to the
<envar>PATH</envar> variable automatically. This means that you do not need to
edit <link linkend="conf-binpath">binpath</link> to include them.
</para></listitem>

<listitem><para>
The path to the <orgname class="nonprofit">KDE</orgname>-provided <application>pkg-config</application> is added
automatically to <envar>PKG_CONFIG_PATH</envar>. This means that you do not
need to use <link linkend="conf-set-env">set-env</link> to add these.
</para></listitem>

<listitem><para>
The setting for <link linkend="conf-kdedir">kdedir</link> is automatically propagated to the <envar>KDEDIR</envar>
environment variable while building. (<envar>KDEDIRS</envar> is not affected).
</para></listitem>

<listitem><para>
The setting for <link linkend="conf-qtdir">qtdir</link> is automatically propagated to the <envar>QTDIR</envar>
environment variable while building.
</para></listitem>

</itemizedlist>

</section>

<section xml:id="build-priority">
<title>Changing <application>kdesrc-build</application>'s build priority</title>
<para>Programs can run with different priority levels on Operating Systems,
including <trademark class="registered">Linux</trademark> and <acronym>BSD</acronym>. This allows the system to allocate time for the
different programs in accordance with how important they are.
</para>

<para><application>kdesrc-build</application> will normally allocate itself a low priority so that the
rest of the programs on your system are unaffected and can run normally.
Using this technique, <application>kdesrc-build</application> will use extra CPU when it is available.
</para>

<para><application>kdesrc-build</application> will still maintain a high enough priority level so that
it runs before routine batch processes and before CPU donation programs
such as <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://setiathome.ssl.berkeley.edu/">Seti@Home</link>.
</para>

<para>To alter <application>kdesrc-build</application> so that it uses a higher (or lower) priority
level permanently, then you need to adjust the <link linkend="conf-niceness">niceness</link> setting in the <link linkend="configure-data">configuration file</link>. The <link linkend="conf-niceness">niceness</link> setting
controls how <quote>nice</quote> <application>kdesrc-build</application> is to other programs. In other
words, having a higher <link linkend="conf-niceness">niceness</link> gives <application>kdesrc-build</application> a lower priority. So to
give <application>kdesrc-build</application> a higher priority, reduce the <link linkend="conf-niceness">niceness</link> (and vice versa).
The <link linkend="conf-niceness">niceness</link> can go from 0 (not nice at all, highest priority) to 20 (super
nice, lowest priority).</para>

<para>You can also temporarily change the priority for <application>kdesrc-build</application> by using
the <link linkend="cmdline-nice">--nice</link> <link linkend="cmdline">command line option</link>. The value to
the option is used exactly the same as for <link linkend="conf-niceness">niceness</link>.</para>

<note><para>It is possible for some programs run by the super user to have a
negative nice value, with a correspondingly even higher priority for such
programs. Setting a negative (or even 0) <link linkend="conf-niceness">niceness</link> for <application>kdesrc-build</application> is not
a great idea, as it will not help run time significantly, but will make your
computer seem very sluggish should you still need to use it.
</para></note>

<informalexample>
<para>To run <application>kdesrc-build</application> with a niceness of 15 (a lower priority than
normal):</para>

<screen>
<prompt>%</prompt> <userinput><command>kdesrc-build</command> <option>--nice=<replaceable>15</replaceable></option></userinput>
</screen>

<para>Or, you can edit the <link linkend="configure-data">configuration file</link> to make the change permanent:</para>

<screen>
    <link linkend="conf-niceness">niceness</link> <replaceable>15</replaceable>
</screen>
</informalexample>

<tip>
<para>The <link linkend="conf-niceness">niceness</link> option only affects the
usage of the computer's processor(s). One other major affect on computer
performance relates to how much data input or output (<acronym>I/O</acronym>) a
program uses. In order to control how much <acronym>I/O</acronym> a program can
use, modern <trademark class="registered">Linux</trademark> operating systems support a similar tool called
<application>ionice</application>. <application>kdesrc-build</application> supports
<application>ionice</application>, (but only to enable or disable it
completely) using the <link linkend="conf-use-idle-io-priority">use-idle-io-priority</link> option,
since <application>kdesrc-build</application> version 1.12.
</para>
</tip>

</section>

<section xml:id="root-installation">
<title>Installation as the superuser</title>
<para>You may wish to have <application>kdesrc-build</application> run the installation with super user
privileges. This may be for the unrecommended system-wide installation.
This is also useful when using a recommended single user <orgname class="nonprofit">KDE</orgname> build, however.
This is because some modules (especially kdebase) install programs that will
briefly need elevated permissions when run. They are not able to achieve these
permission levels unless they are installed with the elevated permissions.
</para>

<para>You could simply run <application>kdesrc-build</application> as the super user directly, but this
is not recommended, since the program has not been audited for that kind of use.
Although it should be safe to run the program in this fashion, it is better to
avoid running as the super user when possible.</para>

<para>To take care of this, <application>kdesrc-build</application> provides the <link linkend="conf-make-install-prefix">make-install-prefix</link>
option. You can use this option to specify a command to use to perform the
installation as another user. The recommended way to use this command is with
the <application>Sudo</application> program, which will run the install command as the super user.
</para>

<informalexample>
<para>For example, to install all modules using <application>Sudo</application>,
you could do something like this:</para>

<screen>
global
  <link linkend="conf-make-install-prefix">make-install-prefix</link> <replaceable>sudo</replaceable>
  # Other options
end global
</screen>

<para>To use <link linkend="conf-make-install-prefix">make-install-prefix</link> for only a single module, this would work:
</para>

<screen>
module <replaceable>svn-module-name</replaceable>
  <link linkend="conf-make-install-prefix">make-install-prefix</link> <replaceable>sudo</replaceable>
end module
</screen>
</informalexample>

</section>

<section xml:id="build-progress">
<title>Showing the progress of a module build</title>
<para>This feature is always available, and is automatically enabled when
possible. What this does is display an estimated build progress while
building a module; that way you know about how much longer it will take to
build a module.
</para>

</section>

</section>

<section xml:id="advanced-features">
<title>Advanced features</title>

<section xml:id="partial-builds">
<title>Partially building a module</title>
<para>It is possible to build only pieces from a single <orgname class="nonprofit">KDE</orgname> module. For
example, you may want to compile only one program from a module. <application>kdesrc-build</application>
has features to make this easy. There are several complementing ways to
do this.
</para>

<section xml:id="checking-out-parts">
<title>Checking out portions of a module</title>

<para>This is perhaps the best way to do this. When it works, it will save you
download time and disk space. What happens is that <application>kdesrc-build</application> will download
only the parts of a module that you specify. This is done using the <link linkend="conf-checkout-only">checkout-only</link>
option for a module, which will specify a list of directories to download.
</para>

<tip><para>
If you do not already know what to download from a module, it may be a good idea
to browse the <application>Subversion</application> layout for a module first, using
<link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://websvn.kde.org/branches/KDE/4.6/">WebSVN</link>. <!--FIXME outdated-->
</para></tip>

<informalexample>
<para>To only grab <application>KUser</application> and <application>KSystemLog</application> from
kdeadmin, you could use <link linkend="conf-checkout-only">checkout-only</link> like this:</para>

<screen>
module <replaceable>kdeadmin</replaceable>
  <link linkend="conf-checkout-only">checkout-only</link> <replaceable>kuser ksystemlog</replaceable>
end module
</screen>

</informalexample>

<important><para>The directories will be built in the order they are listed
in the option. If one of the directories needs something else from the module
to compile, then you need to make sure they are both in the <link linkend="conf-checkout-only">checkout-only</link>
line, and that the required dependency goes before the directory that needs it.</para>

<para>Also, sometimes an application may need other directories and it is hard
to figure out what they are, which may require some trial and error of constantly
adding directories to the option to figure out. This option depends on support
from the build system of the module, so it is only useful for modules that are
collections of individual applications.</para>
</important>

<para>One final note to make about this option: If you change the value of this
option, you should use <userinput><command>kdesrc-build</command>
<option><link linkend="cmdline-refresh-build">--refresh-build</link></option> <option><replaceable>module</replaceable></option></userinput>
in order to ensure that the module is reconfigured properly. In addition,
<application>kdesrc-build</application> will never remove existing files if you take away the number of
directories from your <link linkend="conf-checkout-only">checkout-only</link> option, or add the option to a module that
has already been checked out.</para>

</section>

<section xml:id="not-compiling">
<title>Removing directories from a build</title>
<para>Instead of restricting what is downloaded, it is possible to download
everything but have the build system leave out a few directories when it does
the build. This may be useful if one directory always breaks and is
unnecessary to the rest of the module.
</para>

<para>This is controlled with the <link linkend="conf-do-not-compile">do-not-compile</link> option. It works similar
to the <link linkend="conf-checkout-only">checkout-only</link> option just described, in that it is simply a list of
directories that should not be compiled.</para>

<important><para>
Also like <link linkend="conf-checkout-only">checkout-only</link>, this option requires at least that the
build system for the module is reconfigured after changing
it. This is done using the <userinput><command>kdesrc-build</command>
<option><link linkend="cmdline-reconfigure">--reconfigure</link></option>
<option><replaceable>module</replaceable></option></userinput> command.
</para></important>

<informalexample>
<para>To remove the <filename class="directory">python</filename> directory
from the kdebindings build process:</para>

<screen>
module <replaceable>kdebindings</replaceable>
  <link linkend="conf-do-not-compile">do-not-compile</link> <replaceable>python</replaceable>
end module
</screen>

</informalexample>

<note><para>This function depends on some standard conventions used in most
<orgname class="nonprofit">KDE</orgname> modules. Therefore it may not work for all programs.</para></note>

</section>

</section>

<section xml:id="using-branches">
<title>Branching and tagging support for <application>kdesrc-build</application></title>

<section xml:id="branches-and-tags">
<title>What are branches and tags?</title>

<para><application>Subversion</application> supports managing the history of the <orgname class="nonprofit">KDE</orgname> source code. <orgname class="nonprofit">KDE</orgname>
uses this support to create branches for development, and to tag the repository
every so often with a new version release.
</para>

<para>For example, the <application>KMail</application> developers may be working on a new feature in
a different branch in order to avoid breaking the version being used by most
developers. This branch has development ongoing inside it, even while the
main branch (called /trunk) may have development going on inside of it.
</para>

<para>A tag, on the other hand, is a snapshot of the source code repository
at a position in time. This is used by the <orgname class="nonprofit">KDE</orgname> administration team to mark
off a version of code suitable for release and still allow the developers to
work on the code.
</para>

<para>In <application>Subversion</application>, there is no difference between branches, tags, or trunk within
the code. It is only a convention used by the developers. This makes it
difficult to properly support branches and tags within <application>kdesrc-build</application>. However,
there are some things that can be done.
</para>

</section>

<section xml:id="branch-support">
<title>How to use branches and tags</title>

<para>Support for branches and tags is handled by a set of options, which
range from a generic request for a version, to a specific <acronym>URL</acronym> to download
for advanced users.
</para>

<para>The easiest method is to use the <link linkend="conf-branch">branch</link> and <link linkend="conf-tag">tag</link> options. You simply
use the option along with the name of the desired branch or tag for a module,
and <application>kdesrc-build</application> will try to determine the appropriate location within the
<orgname class="nonprofit">KDE</orgname> repository to download from. For most <orgname class="nonprofit">KDE</orgname> modules this works very
well.</para>

<informalexample>
<para>To download kdelibs from <orgname class="nonprofit">KDE</orgname> 4.6 (which is simply known as the 4.6 branch):
</para>

<screen>
module kdelibs
  branch <replaceable>4.6</replaceable>
  # other options...
end module
</screen>

<para>Or, to download kdemultimedia as it was released with <orgname class="nonprofit">KDE</orgname> 4.6.1:</para>

<screen>
module kdemultimedia
  tag <replaceable>4.6.1</replaceable>
  # other options...
end module
</screen>

</informalexample>

<tip><para>You can specify a global branch value. But if you do so, do not forget
to specify a different branch for modules that should not use the global branch!
</para></tip>
</section>

<section xml:id="advanced-branches">
<title>Advanced branch support options</title>

<para><application>kdesrc-build</application> supports two options for situations where <link linkend="conf-branch">branch</link> and <link linkend="conf-tag">tag</link>
guess the correct path improperly: <link linkend="conf-module-base-path">module-base-path</link> and <link linkend="conf-override-url">override-url</link>.
</para>

<itemizedlist>
<listitem><para>
<link linkend="conf-module-base-path">module-base-path</link> is used to help <application>kdesrc-build</application> fill in the missing part of
a module's path. In the <orgname class="nonprofit">KDE</orgname> repository, all of the paths are of the form
<filename class="directory">svnRoot/module-base-path/<replaceable>module-name</replaceable></filename>. Normally <application>kdesrc-build</application>
can figure out the appropriate middle part by itself. When it cannot, you can use
<link linkend="conf-module-base-path">module-base-path</link>, like this:
</para>

<informalexample>
<screen>
module kdesupport
    # kdesupport supports various tags to easily organize the required
    # software for a given KDE Platform release.
    module-base-path tags/kdesupport-for-4.5
end module
</screen>

<para>This would cause <application>kdesrc-build</application> to download kdesupport from (in this example),
<filename>svn://anonsvn.kde.org/home/kde/<replaceable>tags/kdesupport-for-4.5</replaceable></filename>.
</para>
</informalexample>
<tip><para>In previous versions of <application>kdesrc-build</application>, the <link linkend="conf-module-base-path">module-base-path</link> was
handled differently. If you encounter trouble using an old module-base-path
definition perhaps you should verify that the actual path is as <application>kdesrc-build</application>
expects by using the <link linkend="cmdline-pretend">--pretend</link> option.
</para></tip>
</listitem>

<listitem><para>The <link linkend="conf-override-url">override-url</link> option, on the other hand, requires you to
specify the exact path to download from. However, this allows you to pull from
paths that previous versions of <application>kdesrc-build</application> would have no hope of downloading from.
Currently, the <link linkend="conf-module-base-path">module-base-path</link> option should be sufficient for any Subversion
source URL.
</para>

<important><para>
<application>kdesrc-build</application> will not touch or correct the value you specify for <link linkend="conf-override-url">override-url</link>
at all, so if you change your <link linkend="conf-svn-server">svn-server</link> setting, you may need to update this
as well.
</para></important>

</listitem>
</itemizedlist>

</section>

</section>

<section xml:id="building-successfully">
<title>How <application>kdesrc-build</application> tries to ensure a successful build</title>

<section xml:id="automatic-rebuilds">
<title>Automatic rebuilds</title>

<para><application>kdesrc-build</application> used to include features to automatically attempt to
rebuild the module after a failure (as sometimes this re-attempt would work,
due to bugs in the build system at that time). Thanks to switching to <application>CMake</application>
the build system no longer suffers from these bugs, and so <application>kdesrc-build</application> will
not try to build a module more than once. There are situations where
<application>kdesrc-build</application> will automatically take action though:</para>

<itemizedlist>

<listitem><para>If you change <link linkend="conf-configure-flags">configure-flags</link>
or <link linkend="conf-cmake-options">cmake-options</link> for a module, then
<application>kdesrc-build</application> will detect that and automatically re-run configure or cmake
for that module.</para></listitem>

<listitem><para>If the buildsystem does not exist (even if <application>kdesrc-build</application> did
not delete it) then <application>kdesrc-build</application> will automatically re-create it. This is
useful to allow for performing a full <link linkend="cmdline-refresh-build">--refresh-build</link> for a specific module
without having that performed on other modules.</para></listitem>

</itemizedlist>

</section>

<section xml:id="manual-rebuilds">
<title>Manually rebuilding a module</title>
<para>If you make a change to a module's option settings, or the module's
source code changes in a way <application>kdesrc-build</application> does not recognize, you may need to
manually rebuild the module.</para>

<para>You can do this by simply running <userinput><command>kdesrc-build</command>
 <option>--refresh-build</option> <option><replaceable>module</replaceable></option></userinput>.
</para>

<para>If you would like to have <application>kdesrc-build</application> automatically rebuild the module
during the next normal build update instead, you can create a special file.
Every module has a build directory. If you create a file called <filename>.refresh-me</filename>
in the build directory for a module, <application>kdesrc-build</application> will rebuild the module
next time the build process occurs, even if it would normally perform the
faster incremental build.</para>

<tip>
<para>By default, the build directory is <filename class="directory">~/kdesrc/build/<replaceable>module</replaceable>/</filename>.
If you change the setting of the <link linkend="conf-build-dir">build-dir</link> option, then use that instead of
<filename class="directory">~/kdesrc/build</filename>.</para>
</tip>

<informalexample>
<para>Rebuild using <filename>.refresh-me</filename> for module <replaceable>kdelibs</replaceable>:</para>
<screen>
<prompt>%</prompt> <userinput><command>touch</command> <filename>~/kdesrc/build/<replaceable>kdelibs</replaceable>/.refresh-me</filename></userinput>
<prompt>%</prompt> <userinput><command>kdesrc-build</command></userinput>
</screen>
</informalexample>
</section>

</section>

<section xml:id="changing-environment">
<title>Changing environment variable settings</title>
<para>Normally <application>kdesrc-build</application> uses the environment that is present when
starting up when running programs to perform updates and builds. This is useful
for when you are running <application>kdesrc-build</application> from the command line.</para>

<para>However, you may want to change the setting for environment variables
that <application>kdesrc-build</application> does not provide an option for directly. (For instance,
to setup any required environment variables when running <application>kdesrc-build</application> on
a timer such as <application>Cron</application>) This is possible with the <link linkend="conf-set-env">set-env</link> option.</para>

<para>Unlike most options, it can be set more than once, and it accepts two
entries, separated by a space. The first one is the name of the environment
variable to set, and the remainder of the line is the value.</para>

<informalexample>
<para>Set <userinput><envar>DISTRO</envar>=<replaceable>BSD</replaceable></userinput>
for all modules:</para>
<screen>
global
  set-env <replaceable>DISTRO</replaceable> <replaceable>BSD</replaceable>
end global
</screen>
</informalexample>

</section>

<section xml:id="resuming">
<title>Resuming builds</title>

<section xml:id="resuming-failed">
<title>Resuming a failed or canceled build</title>

<para>You can tell <application>kdesrc-build</application> to start building from a different module
than it normally would. This can be useful when a set of modules failed, or
if you canceled a build run in the middle. You can control this using the
<link linkend="cmdline-resume-from">--resume-from</link> option and the <link linkend="cmdline-resume-after">--resume-after</link> option.</para>

<note><para>Older versions of <application>kdesrc-build</application> would skip the source update when
resuming a build. This is no longer done by default, but you can always use
the <option>--no-src</option> command line option
to skip the source update.</para></note>

<informalexample>
<para>Resuming the build starting from kdebase:</para>

<screen>
<prompt>%</prompt> <userinput><command>kdesrc-build</command> <option>--resume-from=<replaceable>kdebase</replaceable></option></userinput>
</screen>
</informalexample>

<informalexample>
<para>Resuming the build starting after kdebase (in case you manually fixed
the issue and installed the module yourself):</para>

<screen>
<prompt>%</prompt> <userinput><command>kdesrc-build</command> <option>--resume-after=<replaceable>kdebase</replaceable></option></userinput>
</screen>
</informalexample>

<para>If the last <application>kdesrc-build</application> build ended with a build failure, you can also
use the <link linkend="cmdline-resume">--resume</link> command line option,
which resumes the last build starting at the module that failed. The source and
metadata updates are skipped as well (but if you need these, it's generally
better to use <link linkend="cmdline-resume-from">--resume-from</link>
instead).</para>


</section>

<section xml:id="ignoring-modules">
<title>Ignoring modules in a build</title>

<para>Similar to the way you can <link linkend="resuming-failed">resume the
build from a module</link>, you can instead choose to update and build everything
normally, but ignore a set of modules.</para>

<para>You can do this using the <link linkend="cmdline-ignore-modules">--ignore-modules</link> option. This option tells
<application>kdesrc-build</application> to ignore all the modules on the command line when
performing the update and build.</para>

<informalexample>
<para>Ignoring extragear/multimedia and kdereview during a full run:</para>
<screen>
<prompt>%</prompt> <userinput><command>kdesrc-build</command> <option>--ignore-modules</option> <replaceable>extragear/multimedia kdereview</replaceable></userinput>
</screen>
</informalexample>

</section>
</section>

<section xml:id="changing-env-from-cmd-line">
<title>Changing options from the command line</title>

<section xml:id="changing-global-opts">
<title>Changing global options</title>
<para>You can change the setting of options read from the <link linkend="configure-data">configuration file</link> directly
from the command line. This change will override the configuration file
setting, but is only temporary. It only takes effect as long as it is still
present on the command line.</para>

<para><application>kdesrc-build</application> allows you to change options named like <replaceable>option-name</replaceable>
by passing an argument on the command line in the form <userinput><option>--<replaceable>option-name</replaceable>=value</option></userinput>.
<application>kdesrc-build</application> will recognize whether it does not know what the option is, and search
for the name in its list of option names. If it does not recognize the name, it
will warn you, otherwise it will remember the value you set it to and override
any setting from the configuration file.</para>

<informalexample>
<para>Setting the <link linkend="conf-source-dir">source-dir</link> option to <filename>/dev/null</filename> for
testing:</para>

<screen>
<prompt>%</prompt> <userinput><command>kdesrc-build</command> <option>--pretend</option> <option>--<replaceable>source-dir</replaceable>=<replaceable>/dev/null</replaceable></option></userinput>
</screen>

</informalexample>

</section>

<section xml:id="changing-module-opts">
<title>Changing module options</title>
<para>It is also possible to change options only for a specific module. The
syntax is similar: --<replaceable>module</replaceable>,<replaceable>option-name</replaceable>=<replaceable>value</replaceable>.
</para>

<para>This change overrides any duplicate setting for the module found in the
<link linkend="configure-data">configuration file</link>, and applies only while the option is passed on the command line.</para>

<informalexample>
<para>Using a different build directory for the kdeedu module:</para>

<screen>
<prompt>%</prompt> <userinput><command>kdesrc-build</command> <option>--<replaceable>kdeedu</replaceable>,<replaceable>build-dir</replaceable>=<replaceable>temp-build</replaceable></option></userinput>
</screen>

</informalexample>

</section>

</section>

</section>

<section xml:id="developer-features">
<title>Features for <orgname class="nonprofit">KDE</orgname> developers</title>

<section xml:id="ssh-agent-reminder">
<title><application>SSH</application> Agent checks</title>
<para><application>kdesrc-build</application> can ensure that <orgname class="nonprofit">KDE</orgname> developers that use <application>SSH</application> to
access the <orgname class="nonprofit">KDE</orgname> source repository do not accidentally forget to leave the
<application>SSH</application> Agent tool enabled. This can cause <application>kdesrc-build</application> to hang indefinitely
waiting for the developer to type in their <application>SSH</application> password,
so by default <application>kdesrc-build</application> will check if the Agent is running before
performing source updates.
</para>

<note><para>This is only done for <orgname class="nonprofit">KDE</orgname> developers using <application>SSH</application>. This is because
no password is required for the default anonymous checkout. <application>Subversion</application> will
handle passwords for the second possible protocol for <orgname class="nonprofit">KDE</orgname> developers, https.
</para></note>

<para>You may wish to disable the <application>SSH</application> Agent check, in case of situations where
<application>kdesrc-build</application> is mis-detecting the presence of an agent. To disable the
agent check, set the <option>disable-agent-check</option> option to
<userinput>true</userinput>.</para>

<informalexample>
<para>Disabling the <application>SSH</application> agent check:</para>
<screen>
global
  disable-agent-check true
end global
</screen>
</informalexample>

</section>

</section>

<section xml:id="other-features">
<title>Other <application>kdesrc-build</application> features</title>

<section xml:id="changing-verbosity">
<title>Changing the amount of output from <application>kdesrc-build</application></title>
<para><application>kdesrc-build</application> has several options to control the amount of output the
script generates. In any case, errors will always be output.</para>

<itemizedlist>
<listitem><para>The <option>--quiet</option> option (short form is
<option>-q</option>) causes <application>kdesrc-build</application> to be mostly silent. Only important
messages, warnings, or errors will be shown. When available, build progress
information is still shown.</para></listitem>

<listitem><para>The <option>--really-quiet</option> option (no short form)
causes <application>kdesrc-build</application> to only display important warnings or errors while it is
running.</para></listitem>

<listitem><para>The <option>--verbose</option> option (short form is
<option>-v</option>) causes <application>kdesrc-build</application> to be very detailed in its
output.</para></listitem>

<listitem><para>The <option>--debug</option> option is for debugging purposes
only, it causes <application>kdesrc-build</application> to act as if <option>--verbose</option> was
turned on, causes commands to also output to the terminal, and will display
debugging information for many functions.</para></listitem>
</itemizedlist>

</section>

<section xml:id="kdesrc-build-color">
<title>Color output</title>
<para>When being run from <application>Konsole</application> or a different terminal, <application>kdesrc-build</application>
will normally display with colorized text.</para>

<para>You can disable this by using the <option>--no-color</option> on the
command line, or by setting the <link linkend="conf-colorful-output">colorful-output</link> option in the <link linkend="configure-data">configuration file</link> to
<userinput>false</userinput>.
</para>

<informalexample>
<para>Disabling color output in the configuration file:</para>
<screen>
global
  colorful-output false
end global
</screen>
</informalexample>

</section>

<section xml:id="deleting-build-dir">
<title>Removing unneeded directories after a build</title>
<para>Are you short on disk space but still want to run a bleeding-edge
<orgname class="nonprofit">KDE</orgname> checkout?  <application>kdesrc-build</application> can help reduce your disk usage when building
<orgname class="nonprofit">KDE</orgname> from <application>Subversion</application>.</para>

<note><para>Be aware that building <orgname class="nonprofit">KDE</orgname> does take a lot of space. There are
several major space-using pieces when using <application>kdesrc-build</application>:</para></note>

<orderedlist>
<listitem><para>The actual source checkout can take up a fair amount of space.
The default modules take up about 1.6 gigabytes of on-disk space. You can reduce
this amount by making sure that you are only building as many modules as you
actually want. <application>kdesrc-build</application> will not delete source code from disk even if you
delete the entry from the <link linkend="configure-data">configuration file</link>, so make sure that you go and delete unused
source checkouts from the source directory. Note that the source files are
downloaded from the Internet, you <emphasis>should not</emphasis> delete them
if you are actually using them, at least until you are done using
<application>kdesrc-build</application>.</para>

<para>Also, if you already have a <trademark class="trade">Qt</trademark> installed by your distribution (and
the odds are good that you do), you probably do not need to install the
qt module. That will shave about 200 megabytes off of the on-disk source
size.</para>

<para>One thing to note is that due to the way <application>Subversion</application> works: there are actually
two files on disk for every file checked-out from the repository. <application>kdesrc-build</application>
does not have code at this point to try and minimize the source size when the
source is not being used.
</para>
</listitem>

<listitem>
<para><application>kdesrc-build</application> will create a separate build directory to build the source
code in. Sometimes <application>kdesrc-build</application> will have to copy a source directory to
create a fake build directory. When this happens, space-saving symlinks are
used, so this should not be a hassle on disk space. The build directory will
typically be much larger than the source directory for a module. For example,
the build directory for kdebase is about 1050 megabytes, whereas kdebase's
source is only around 550 megabytes.</para>

<para>Luckily, the build directory is not required after a module has
successfully been built and installed. <application>kdesrc-build</application> can automatically
remove the build directory after installing a module, see the examples below
for more information. Note that taking this step will make it impossible
for <application>kdesrc-build</application> to perform the time-saving incremental builds.</para>
</listitem>

<listitem><para>
Finally, there is disk space required for the actual installation of
<orgname class="nonprofit">KDE</orgname>, which does not run from the build directory. This typically takes less
space than the build directory. It is harder to get exact figures however.
</para></listitem>
</orderedlist>

<para>How do you reduce the space requirements of <orgname class="nonprofit">KDE</orgname>?  One way is to
use the proper compiler flags, to optimize for space reduction instead of
for speed. Another way, which can have a large effect, is to remove debugging
information from your <orgname class="nonprofit">KDE</orgname> build.
</para>

<warning><para>
You should be very sure you know what you are doing before deciding to remove
debugging information. Running bleeding-edge software means you are running
software which is potentially much more likely to crash than a stable release.
If you are running software without debugging information, it can be very
hard to create a good bug report to get your bug resolved, and you will likely
have to re-enable debugging information for the affected application and
rebuild to help a developer fix the crash. So, remove debugging information
at your own risk!
</para></warning>

<informalexample>
<para>Removing the build directory after installation of a module. The source
directory is still kept, and debugging is enabled:</para>

<screen>
global
  configure-flags      --enable-debug
  remove-after-install builddir        # Remove build directory after install
end global
</screen>

<para>Removing the build directory after installation, without debugging
information, with size optimization.</para>

<screen>
global
  cxxflags             -Os             # Optimize for size
  configure-flags      --disable-debug
  remove-after-install builddir        # Remove build directory after install
end global
</screen>
</informalexample>
</section>

</section>

</chapter>

<chapter xml:id="kde-cmake">
<title><application>CMake</application>, the <orgname class="nonprofit">KDE</orgname> build system</title>

<section xml:id="kde-cmake-intro">
<title>Introduction to <application>CMake</application></title>

<para>In March 2006, the <application>CMake</application> program
beat out several competitors and was selected to be the build system for <orgname class="nonprofit">KDE</orgname> 4, replacing the
autotools-based system that <orgname class="nonprofit">KDE</orgname> had used from the beginning.</para>

<para>A introduction to <application>CMake</application> page is available on the <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://community.kde.org/Guidelines_HOWTOs/CMake"><orgname class="nonprofit">KDE</orgname> Community Wiki</link>.
Basically, instead of running <userinput><command>make</command> <option>-f</option>
<filename>Makefile.cvs</filename></userinput>, then <command>configure</command>,
then <application>Make</application>, we simply run <application>CMake</application> and then <application>Make</application>.
</para>

<para><application>kdesrc-build</application> has support for <application>CMake</application>. A few features of <application>kdesrc-build</application>
were really features of the underlying buildsystem, including
<link linkend="conf-configure-flags">configure-flags</link>
and <link linkend="conf-do-not-compile">do-not-compile</link>. When equivalent
features are available, they are provided. For instance, the equivalent to the
configure-flags option is <link linkend="conf-cmake-options">cmake-options</link>, and the
<link linkend="conf-do-not-compile">do-not-compile</link> option is also supported for <application>CMake</application>
as of <application>kdesrc-build</application> version 1.6.3.
</para>

</section>
</chapter>

<chapter xml:id="credits-and-license">
<title>Credits And License</title>

<!-- TRANS:CREDIT_FOR_TRANSLATORS -->
<para xml:id="gnu-fdl" xreflabel="the section entitled &quot;GNU Free Documentation License&quot;">This documentation is licensed under the terms of the <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="fdl-license.html" type="commondoc">GNU Free Documentation
License</link>.</para>


</chapter>

<appendix xml:id="appendix-modules">
<title><orgname class="nonprofit">KDE</orgname> modules and source code organization</title>
<section xml:id="module-concept">
<title>The <quote>Module</quote></title>

<para><orgname class="nonprofit">KDE</orgname> groups its software into <quote>modules</quote> of various size.
This was initially a loose grouping of a few large modules, but with the
introduction of the <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://git-scm.com/">Git</link>-based <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://commits.kde.org/">source code repositories</link>, these large
modules were further split into many smaller modules.
</para>

<para><application>kdesrc-build</application> uses this module concept as well. In essence, a
<quote>module</quote> is a grouping of code that can be downloaded, built,
tested, and installed.
</para>

<section xml:id="single-modules">
<title>Individual modules</title>

<para>It is easy to set <application>kdesrc-build</application> to build a single module. The following
listing is an example of what a declaration for a Subversion-based module would
look like in <link linkend="kdesrc-buildrc">the configuration
file</link>.</para>

<programlisting>
module <replaceable>kdefoo</replaceable>
    <option><replaceable>cmake-options -DCMAKE_BUILD_TYPE=Debug</replaceable></option>
end module
</programlisting>

<tip><para>This is a Subversion-based module since it doesn't use a <link linkend="conf-repository">repository</link> option. Also, the
<option>cmake-options</option> option is listed as an example only, it is not
required.</para></tip>

</section>
<section xml:id="module-groups">
<title>Groups of related modules</title>

<para>Now most <orgname class="nonprofit">KDE</orgname> source modules are Git-based <orgname class="nonprofit">KDE</orgname>, and are normally
combined into groups of modules.</para>

<para><application>kdesrc-build</application> therefore supports groups of modules as well, using
<link linkend="module-sets">module sets</link>. An example:</para>

<programlisting>
module-set <replaceable>base-modules</replaceable>
    <option>repository</option> kde-projects
    <option>use-modules</option> <replaceable>kde-runtime kde-workspace kde-baseapps</replaceable>
end module-set
</programlisting>

<tip><para>You can leave the module set name (<replaceable>base-modules</replaceable>
in this case) empty if you like. This <option>repository</option> setting tells
<application>kdesrc-build</application> where to download the source from, but you can also use a
<symbol>git://</symbol> URL.</para></tip>

<para>One special feature of the <quote><option>repository</option>
<literal>kde-projects</literal></quote> is that <application>kdesrc-build</application> will
automatically include any Git modules that are grouped under the modules you
list (in the KDE Project database).</para>
</section>

<section xml:id="module-branch-groups">
<title>Module <quote>branch groups</quote></title>

<para>Taking the concept of a <link linkend="module-groups">group of
modules</link> further, the <orgname class="nonprofit">KDE</orgname> developers eventually found that
synchronizing the names of the Git branches across a large number of
repositories was getting difficult, especially during the development push for
the new <orgname class="nonprofit">KDE</orgname> Frameworks for <trademark class="trade">Qt</trademark> 5.
</para>

<para>So the concept of <quote>branch groups</quote> was developed, to allow
users and developers to select one of only a few groups, and allow the script
to automatically select the appropriate Git branch.
</para>

<para><application>kdesrc-build</application> supports this feature as of version 1.16-pre2, via the
<link linkend="conf-branch-group">branch-group</link> option.
</para>

<example xml:id="ex-branch-group">
<title>Example of using branch-group</title>

<para>branch-group can be used in the configuration file as follows:
</para>

<programlisting>
global
    # Select KDE Frameworks 5 and other Qt5-based apps
    <option>branch-group</option> <replaceable>kf5-qt5</replaceable>

    # Other global options here ...
end global

module-set
    # branch-group only works for kde-projects
    <option>repository</option> kde-projects

    # branch-group is inherited from the one set globally, but could
    # specified here.

    <option>use-modules</option> <replaceable>kdelibs kde-workspace</replaceable>
end module-set

# kdelibs's branch will be "frameworks"
# kde-workspace's branch will be "master" (as of August 2013)
</programlisting>

<para>In this case the same <literal>branch-group</literal> gives different
branch names for each Git module.
</para>
</example>

<para>This feature requires some data maintained by the <orgname class="nonprofit">KDE</orgname> developers in a Git
repository named <literal>kde-build-metadata</literal>, however this module
will be included automatically by <application>kdesrc-build</application> (though you may see it appear
in the script output).
</para>

<tip><para><orgname class="nonprofit">KDE</orgname> modules that do not have a set branch name for the branch
group you choose will default to an appropriate branch name, as if you had not
specified <literal>branch-group</literal> at all.
</para></tip>

</section>

</section>
</appendix>

<appendix xml:id="appendix-profile">
<title>Superseded profile setup procedures</title>

<section xml:id="old-profile-setup">
<title>Setting up a <orgname class="nonprofit">KDE</orgname> login profile</title>

<para>These instructions cover how to setup the profile required to ensure your
computer can login to your newly-built <orgname class="nonprofit">KDE</orgname> <productname>Plasma</productname> desktop. <application>kdesrc-build</application>
will normally try to do this automatically (see <xref linkend="session-driver"/>). This appendix section can be useful for those who
cannot use <application>kdesrc-build</application>'s support for login profile setup. However the
instructions may not always be up-to-date, it can also be useful to consult the
<filename>kde-env-master.sh</filename> file included with the <application>kdesrc-build</application>
source.</para>

<section xml:id="changing-profile">
<title>Changing your startup profile settings</title>

<important><para>The <filename>.bash_profile</filename> is the login settings
file for the popular <application>bash</application> shell used by many <trademark class="registered">Linux</trademark>
distributions. If you use a different shell, then you may need to adjust the
samples given in this section for your particular shell.</para></important>

<para>
Open or create the <filename>.bash_profile</filename> file in the home directory with your favorite editor,
and add to the end of the file:

If you are building the qt module (you are by default), add instead:

<programlisting>
QTDIR=(path to qtdir)   # Such as ~/kdesrc/build/qt by default.
KDEDIR=(path to kdedir) # Such as ~/kde by default.
KDEDIRS=$KDEDIR
PATH=$KDEDIR/bin:$QTDIR/bin:$PATH
MANPATH=$QTDIR/doc/man:$MANPATH

# Act appropriately if LD_LIBRARY_PATH is not already set.
if [ -z $LD_LIBRARY_PATH ]; then
  LD_LIBRARY_PATH=$KDEDIR/lib:$QTDIR/lib
else
  LD_LIBRARY_PATH=$KDEDIR/lib:$QTDIR/lib:$LD_LIBRARY_PATH
fi

export QTDIR KDEDIRS PATH MANPATH LD_LIBRARY_PATH
</programlisting>

or, if you are not building qt (and are using your system <trademark class="trade">Qt</trademark> instead), add
this instead:

<programlisting>
KDEDIR=(path to kdedir)  # Such as ~/kde by default.
KDEDIRS=$KDEDIR
PATH=$KDEDIR/bin:$QTDIR/bin:$PATH

# Act appropriately if LD_LIBRARY_PATH is not already set.
if [ -z $LD_LIBRARY_PATH ]; then
  LD_LIBRARY_PATH=$KDEDIR/lib
else
  LD_LIBRARY_PATH=$KDEDIR/lib:$LD_LIBRARY_PATH
fi

export KDEDIRS PATH LD_LIBRARY_PATH
</programlisting>
</para>

<para>
If you are not using a dedicated user, set a different $<envar>KDEHOME</envar>
for your new environment in your <filename>.bash_profile</filename>:

<programlisting>
export KDEHOME="${HOME}/.kde-svn"

# Create it if needed
[ ! -e ~/.kde-svn ] &amp;&amp; mkdir ~/.kde-svn
</programlisting>
</para>

<note><para>
If later your K Menu is empty or too crowded with applications from your
distribution, you may have to set the <acronym>XDG</acronym> environment
variables in your <filename>.bash_profile</filename>:</para>
<programlisting>
XDG_CONFIG_DIRS="/etc/xdg"
XDG_DATA_DIRS="${KDEDIR}/share:/usr/share"
export XDG_CONFIG_DIRS XDG_DATA_DIRS</programlisting></note>

</section>
<section xml:id="starting-kde">
<title>Starting <orgname class="nonprofit">KDE</orgname></title>

<para>
Now that you have adjusted your environment settings to use the correct <orgname class="nonprofit">KDE</orgname>,
it is important to ensure that the correct <command>startkde</command> script
is used as well.
</para>

<para>
Open the <filename>.xinitrc</filename> text file from the home directory, or
create it if necessary. Add the line:

<programlisting>
<command>exec</command> <option>${KDEDIR}/bin/startkde</option>
</programlisting>
</para>

<important><para>On some distributions, it may be necessary to perform the same
steps with the <filename>.xsession</filename> file, also in the home directory.
This is especially true when using graphical login managers such as
<application>kdm</application>, <application>gdm</application>, or <application>xdm</application>.</para>
</important>

<para>
Now start your fresh <orgname class="nonprofit">KDE</orgname>: in <acronym>BSD</acronym> and <trademark class="registered">Linux</trademark> systems with virtual terminal support,
<keycombo action="simul"><keycap>Ctrl</keycap><keycap>Alt</keycap><keycap>F1</keycap></keycombo> ... <keycombo action="simul"><keycap>Ctrl</keycap><keycap>Alt</keycap><keycap>F12</keycap></keycombo> keystroke combinations are used to switch to Virtual Console 1 through 12.
This allows you to run more than one desktop environment at the same time. The fist six are
text terminals and the following six are graphical displays.
</para>

<para>
If when you start your computer you are presented to the graphical display
manager instead, you can use the new <orgname class="nonprofit">KDE</orgname> environment, even if it is not listed
as an option. Most display managers, including <application>kdm</application>, have an option to use
a <quote>Custom Session</quote> when you login. With this option, your session settings are
loaded from the <filename>.xsession</filename> file in your home directory. If
you have already modified this file as described above, this option should load
you into your new <orgname class="nonprofit">KDE</orgname> installation.
</para>

<para>If it does not, there is something else you can try that should normally
work: Press <keycombo action="simul"><keycap>Ctrl</keycap><keycap>Alt</keycap><keycap>F2</keycap></keycombo>,
and you will be presented to a text terminal. Log in using the dedicated user
and type:
</para>

<screen>
<command>startx</command> <option>--</option> <option>:1</option>
</screen>

<tip>
<para>
You can run the <orgname class="nonprofit">KDE</orgname> from sources and the old <orgname class="nonprofit">KDE</orgname> at the same time! Log in
using your regular user, start the stable <orgname class="nonprofit">KDE</orgname> desktop. Press <keycombo action="simul"><keycap>Ctrl</keycap><keycap>Alt</keycap><keycap>F2</keycap></keycombo> (or
<keycap>F1</keycap>, <keycap>F3</keycap>, etc..), and you will be presented
with a text terminal. Log in using the dedicated <orgname class="nonprofit">KDE</orgname> <application>Subversion</application> user and
type:</para>

<screen>
<command>startx</command> <option>--</option> <option>:1</option>
</screen>

<para>You can go back to the <orgname class="nonprofit">KDE</orgname> desktop of your regular user by pressing the
shortcut key for the already running desktop. This is normally
<keycombo action="simul"><keycap>Ctrl</keycap><keycap>Alt</keycap><keycap>F7</keycap></keycombo>, you may need
to use <keycap>F6</keycap> or <keycap>F8</keycap> instead. To return to your
<application>kdesrc-build</application>-compiled <orgname class="nonprofit">KDE</orgname>, you would use the same sequence, except with the
next function key. For example, if you needed to enter <keycombo action="simul"><keycap>Ctrl</keycap><keycap>Alt</keycap><keycap>F7</keycap></keycombo>
to switch to your regular <orgname class="nonprofit">KDE</orgname>, you would need to enter
<keycombo action="simul"><keycap>Ctrl</keycap><keycap>Alt</keycap><keycap>F8</keycap></keycombo> to go back
to your <application>kdesrc-build</application> <orgname class="nonprofit">KDE</orgname>.</para>
</tip>

</section>
</section>

</appendix>
</book>
